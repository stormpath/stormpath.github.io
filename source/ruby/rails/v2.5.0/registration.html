

<!DOCTYPE html>
<!--[if IE 8]><html class="no-js lt-ie9" lang="en" > <![endif]-->
<!--[if gt IE 8]><!--> <html class="no-js" lang="en" > <!--<![endif]-->
<head>
  <meta charset="utf-8">
  
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  
  <title>Registration &mdash; Stormpath Rails Documentation 0.1 documentation</title>
  

  
  

  

  
  
    

  

  
  
    <link rel="stylesheet" href="_static/css/theme.css" type="text/css" />
  

  

  
        <link rel="author" title="About these documents"
              href="about.html"/>
        <link rel="index" title="Index"
              href="genindex.html"/>
        <link rel="search" title="Search" href="search.html"/>
    <link rel="top" title="Stormpath Rails Documentation 0.1 documentation" href="index.html"/>
        <link rel="next" title="Login" href="login.html"/>
        <link rel="prev" title="Authentication" href="authentication.html"/> 

  
  <script src="_static/js/modernizr.min.js"></script>

  
  <script src="https://cdn.optimizely.com/js/225847041.js"></script>

  
  <script>
  !function(f,b,e,v,n,t,s){if(f.fbq)return;n=f.fbq=function(){n.callMethod?
  n.callMethod.apply(n,arguments):n.queue.push(arguments)};if(!f._fbq)f._fbq=n;
  n.push=n;n.loaded=!0;n.version='2.0';n.queue=[];t=b.createElement(e);t.async=!0;
  t.src=v;s=b.getElementsByTagName(e)[0];s.parentNode.insertBefore(t,s)}(window,
  document,'script','https://connect.facebook.net/en_US/fbevents.js');
  fbq('init', '986262161469311');
  fbq('track', 'PageView');
  </script>
  <noscript><img height="1" width="1" style="display:none"
  src="https://www.facebook.com/tr?id=986262161469311&ev=PageView&noscript=1"
  /></noscript>
</head>

<body class="wy-body-for-nav" role="document">

  
  <noscript><iframe src="//www.googletagmanager.com/ns.html?id=GTM-NQZZFW"
  height="0" width="0" style="display:none;visibility:hidden"></iframe></noscript>
  <script>(function(w,d,s,l,i){w[l]=w[l]||[];w[l].push({'gtm.start':
  new Date().getTime(),event:'gtm.js'});var f=d.getElementsByTagName(s)[0],
  j=d.createElement(s),dl=l!='dataLayer'?'&l='+l:'';j.async=true;j.src=
  '//www.googletagmanager.com/gtm.js?id='+i+dl;f.parentNode.insertBefore(j,f);
  })(window,document,'script','dataLayer','GTM-NQZZFW');</script>

   
  <div class="wy-grid-for-nav">

    
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-scroll">
        <div class="wy-side-nav-search">
          

          
            <a href="index.html" class="icon icon-home"> Stormpath Rails Documentation
          

          
          </a>

          

          
<div role="search">
  <form id="rtd-search-form" class="wy-form" action="search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>

          
        </div>

        <div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="main navigation">
          
            
            
                <ul class="current">
<li class="toctree-l1"><a class="reference internal" href="about.html">About</a><ul>
<li class="toctree-l2"><a class="reference internal" href="about.html#what-is-stormpath">What is Stormpath?</a></li>
<li class="toctree-l2"><a class="reference internal" href="about.html#what-is-the-stormpath-rails-gem">What is the Stormpath Rails Gem?</a></li>
<li class="toctree-l2"><a class="reference internal" href="about.html#who-should-use-stormpath">Who should use Stormpath?</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="quickstart.html">Quickstart</a><ul>
<li class="toctree-l2"><a class="reference internal" href="quickstart.html#create-a-stormpath-account">Create a Stormpath Account</a></li>
<li class="toctree-l2"><a class="reference internal" href="quickstart.html#create-an-api-key-pair">Create an API Key Pair</a></li>
<li class="toctree-l2"><a class="reference internal" href="quickstart.html#find-your-stormpath-application">Find Your Stormpath Application</a></li>
<li class="toctree-l2"><a class="reference internal" href="quickstart.html#install-the-gem">Install the Gem</a></li>
<li class="toctree-l2"><a class="reference internal" href="quickstart.html#routes-configuration">Routes configuration</a></li>
<li class="toctree-l2"><a class="reference internal" href="quickstart.html#start-your-server">Start your server</a></li>
<li class="toctree-l2"><a class="reference internal" href="quickstart.html#example-applications">Example Applications</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="configuration.html">Configuration</a><ul>
<li class="toctree-l2"><a class="reference internal" href="configuration.html#environment-variables">Environment Variables</a></li>
<li class="toctree-l2"><a class="reference internal" href="configuration.html#default-features">Default Features</a></li>
<li class="toctree-l2"><a class="reference internal" href="configuration.html#disabling-features">Disabling Features</a></li>
<li class="toctree-l2"><a class="reference internal" href="configuration.html#stormpath-client-options">Stormpath Client Options</a></li>
<li class="toctree-l2"><a class="reference internal" href="configuration.html#stormpath-application">Stormpath Application</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="user_data.html">User Data</a><ul>
<li class="toctree-l2"><a class="reference internal" href="user_data.html#current-account">current_account</a><ul>
<li class="toctree-l3"><a class="reference internal" href="user_data.html#resolving-the-current-user-account">Resolving The Current User(Account)</a></li>
<li class="toctree-l3"><a class="reference internal" href="user_data.html#forcing-authentication">Forcing Authentication</a></li>
<li class="toctree-l3"><a class="reference internal" href="user_data.html#modifying-the-account">Modifying The Account</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="user_data.html#custom-data">Custom Data</a></li>
<li class="toctree-l2"><a class="reference internal" href="user_data.html#automatic-expansion">Automatic Expansion</a></li>
<li class="toctree-l2"><a class="reference internal" href="user_data.html#current-user-json-api">Current User JSON API</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="authentication.html">Authentication</a><ul>
<li class="toctree-l2"><a class="reference internal" href="authentication.html#cookie-authentication">Cookie Authentication</a><ul>
<li class="toctree-l3"><a class="reference internal" href="authentication.html#setting-token-expiration-time">Setting Token Expiration Time</a></li>
<li class="toctree-l3"><a class="reference internal" href="authentication.html#configuring-cookie-flags">Configuring Cookie Flags</a></li>
<li class="toctree-l3"><a class="reference internal" href="authentication.html#token-validation-strategy">Token Validation Strategy</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="authentication.html#http-basic-authentication">HTTP Basic Authentication</a></li>
<li class="toctree-l2"><a class="reference internal" href="authentication.html#oauth2-client-credentials">OAuth2 Client Credentials</a></li>
<li class="toctree-l2"><a class="reference internal" href="authentication.html#oauth2-password-grant">OAuth2 Password Grant</a></li>
</ul>
</li>
<li class="toctree-l1 current"><a class="current reference internal" href="#">Registration</a><ul>
<li class="toctree-l2"><a class="reference internal" href="#configuration-options">Configuration Options</a></li>
<li class="toctree-l2"><a class="reference internal" href="#modifying-default-fields">Modifying Default Fields</a><ul>
<li class="toctree-l3"><a class="reference internal" href="#configure-first-name-and-last-name-as-optional">Configure First Name and Last Name as Optional</a></li>
<li class="toctree-l3"><a class="reference internal" href="#disabling-first-name-and-last-name">Disabling First Name and Last Name</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="#creating-custom-fields">Creating Custom Fields</a></li>
<li class="toctree-l2"><a class="reference internal" href="#changing-field-order">Changing Field Order</a></li>
<li class="toctree-l2"><a class="reference internal" href="#password-strength-rules">Password Strength Rules</a></li>
<li class="toctree-l2"><a class="reference internal" href="#email-verification">Email Verification</a></li>
<li class="toctree-l2"><a class="reference internal" href="#auto-login">Auto Login</a></li>
<li class="toctree-l2"><a class="reference internal" href="#overriding-registration">Overriding Registration</a><ul>
<li class="toctree-l3"><a class="reference internal" href="#controllers">Controllers</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="#routes">Routes</a></li>
<li class="toctree-l2"><a class="reference internal" href="#views">Views</a></li>
<li class="toctree-l2"><a class="reference internal" href="#json-registration-api">JSON Registration API</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="login.html">Login</a><ul>
<li class="toctree-l2"><a class="reference internal" href="login.html#next-uri">Next URI</a></li>
<li class="toctree-l2"><a class="reference internal" href="login.html#form-customization">Form Customization</a></li>
<li class="toctree-l2"><a class="reference internal" href="login.html#controller-private-helper-methods">Controller private &amp; helper methods</a></li>
<li class="toctree-l2"><a class="reference internal" href="login.html#json-login-api">JSON Login API</a></li>
<li class="toctree-l2"><a class="reference internal" href="login.html#overriding-login">Overriding Login</a><ul>
<li class="toctree-l3"><a class="reference internal" href="login.html#controllers">Controllers</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="login.html#routes">Routes</a></li>
<li class="toctree-l2"><a class="reference internal" href="login.html#views">Views</a></li>
<li class="toctree-l2"><a class="reference internal" href="login.html#using-id-site">Using ID Site</a><ul>
<li class="toctree-l3"><a class="reference internal" href="login.html#id-site-configuration">ID Site Configuration</a></li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="social_login.html">Social Login</a><ul>
<li class="toctree-l2"><a class="reference internal" href="social_login.html#facebook-login">Facebook Login</a><ul>
<li class="toctree-l3"><a class="reference internal" href="social_login.html#create-a-facebook-app">Create a Facebook App</a></li>
<li class="toctree-l3"><a class="reference internal" href="social_login.html#specify-allowed-urls">Specify Allowed URLs</a></li>
<li class="toctree-l3"><a class="reference internal" href="social_login.html#create-a-facebook-directory">Create a Facebook Directory</a></li>
<li class="toctree-l3"><a class="reference internal" href="social_login.html#test-it-out">Test it Out</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="social_login.html#google-login">Google Login</a><ul>
<li class="toctree-l3"><a class="reference internal" href="social_login.html#create-a-google-project">Create a Google Project</a></li>
<li class="toctree-l3"><a class="reference internal" href="social_login.html#enable-google-login">Enable Google Login</a></li>
<li class="toctree-l3"><a class="reference internal" href="social_login.html#create-oauth-credentials">Create OAuth Credentials</a></li>
<li class="toctree-l3"><a class="reference internal" href="social_login.html#create-a-google-directory">Create a Google Directory</a></li>
<li class="toctree-l3"><a class="reference internal" href="social_login.html#id2">Test it Out</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="social_login.html#linkedin-login">LinkedIn Login</a><ul>
<li class="toctree-l3"><a class="reference internal" href="social_login.html#create-a-linkedin-application">Create a LinkedIn Application</a></li>
<li class="toctree-l3"><a class="reference internal" href="social_login.html#enable-linkedin-permissions">Enable LinkedIn Permissions</a></li>
<li class="toctree-l3"><a class="reference internal" href="social_login.html#create-a-linkedin-directory">Create a LinkedIn Directory</a></li>
<li class="toctree-l3"><a class="reference internal" href="social_login.html#id3">Test it Out</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="social_login.html#github-login">Github Login</a><ul>
<li class="toctree-l3"><a class="reference internal" href="social_login.html#create-a-github-app">Create a Github App</a></li>
<li class="toctree-l3"><a class="reference internal" href="social_login.html#create-a-github-directory">Create a Github Directory</a></li>
<li class="toctree-l3"><a class="reference internal" href="social_login.html#id4">Test it Out</a></li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="logout.html">Logout</a><ul>
<li class="toctree-l2"><a class="reference internal" href="logout.html#configuration-options">Configuration Options</a></li>
<li class="toctree-l2"><a class="reference internal" href="logout.html#overriding-logout">Overriding Logout</a><ul>
<li class="toctree-l3"><a class="reference internal" href="logout.html#controllers">Controllers</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="logout.html#routes">Routes</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="password_reset.html">Password Reset</a><ul>
<li class="toctree-l2"><a class="reference internal" href="password_reset.html#enable-the-workflow">Enable the Workflow</a></li>
<li class="toctree-l2"><a class="reference internal" href="password_reset.html#adjust-workflow-in-config-file">Adjust Workflow in Config File</a></li>
<li class="toctree-l2"><a class="reference internal" href="password_reset.html#using-the-workflow">Using the Workflow</a></li>
<li class="toctree-l2"><a class="reference internal" href="password_reset.html#auto-login">Auto Login</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="devise_import.html">Import Data from Devise</a><ul>
<li class="toctree-l2"><a class="reference internal" href="devise_import.html#default-configuration">Default Configuration</a></li>
<li class="toctree-l2"><a class="reference internal" href="devise_import.html#new-application-and-directory">New Application and Directory</a></li>
<li class="toctree-l2"><a class="reference internal" href="devise_import.html#custom-account-data">Custom Account Data</a></li>
<li class="toctree-l2"><a class="reference internal" href="devise_import.html#migration-process">Migration Process</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="templates.html">Templates</a><ul>
<li class="toctree-l2"><a class="reference internal" href="templates.html#default-views">Default Views</a></li>
<li class="toctree-l2"><a class="reference internal" href="templates.html#custom-views">Custom Views</a></li>
<li class="toctree-l2"><a class="reference internal" href="templates.html#view-variables">View Variables</a></li>
<li class="toctree-l2"><a class="reference internal" href="templates.html#response-variables">Response Variables</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="help.html">Getting Help</a></li>
<li class="toctree-l1"><a class="reference internal" href="contributors.html">Contributors</a><ul>
<li class="toctree-l2"><a class="reference internal" href="contributors.html#developers">Developers</a><ul>
<li class="toctree-l3"><a class="reference internal" href="contributors.html#nenad-nikolic">Nenad Nikolić</a></li>
<li class="toctree-l3"><a class="reference internal" href="contributors.html#damir-svrtan">Damir Svrtan</a></li>
<li class="toctree-l3"><a class="reference internal" href="contributors.html#marko-cilimkovic">Marko Ćilimković</a></li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="changelog.html">Change Log</a><ul>
<li class="toctree-l2"><a class="reference internal" href="changelog.html#version-2-5-0">Version 2.5.0</a></li>
<li class="toctree-l2"><a class="reference internal" href="changelog.html#version-2-4-0">Version 2.4.0</a></li>
<li class="toctree-l2"><a class="reference internal" href="changelog.html#version-2-3-1">Version 2.3.1</a></li>
<li class="toctree-l2"><a class="reference internal" href="changelog.html#version-2-3-0">Version 2.3.0</a></li>
<li class="toctree-l2"><a class="reference internal" href="changelog.html#version-2-2-0">Version 2.2.0</a></li>
<li class="toctree-l2"><a class="reference internal" href="changelog.html#version-2-1-0">Version 2.1.0</a></li>
<li class="toctree-l2"><a class="reference internal" href="changelog.html#version-2-0-2">Version 2.0.2</a></li>
<li class="toctree-l2"><a class="reference internal" href="changelog.html#version-2-0-1">Version 2.0.1</a></li>
</ul>
</li>
</ul>

            
          
        </div>
      </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap">

      
      <nav class="wy-nav-top" role="navigation" aria-label="top navigation">
        
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href="index.html">Stormpath Rails Documentation</a>
        
      </nav>


      
      <div class="wy-nav-content">
        <div class="rst-content">
          

 







<div role="navigation" aria-label="breadcrumbs navigation">
  <ul class="wy-breadcrumbs">
    <li><a href="index.html">Docs</a> &raquo;</li>
      
    <li>Registration</li>
    <li class="wy-breadcrumbs-aside">
      
          
          <a href="_sources/registration.rst.txt" rel="nofollow"> View page source</a>
        
      
    </li>
  </ul>
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
           <div itemprop="articleBody">
            
  <div class="section" id="registration">
<span id="id1"></span><h1>Registration<a class="headerlink" href="#registration" title="Permalink to this headline">¶</a></h1>
<p>The registration feature of this gem allows you to use Stormpath to create
new accounts in a Stormpath directory.  You can create traditional password-
based accounts, which have a username and a password, or you can create customized accounts with multiple required or optional fields.</p>
<p>By default this gem will serve an HTML registration page at <code class="docutils literal"><span class="pre">/register</span></code>.
You can change this URI with the <code class="docutils literal"><span class="pre">web.register.uri</span></code> option.  You can disable
this feature entirely by setting <code class="docutils literal"><span class="pre">web.register.enabled</span></code> to <code class="docutils literal"><span class="pre">false</span></code> in your <code class="docutils literal"><span class="pre">stormpath.yml</span></code> configuration file.</p>
<p><a class="reference external" href="http://localhost:3000/register">http://localhost:3000/register</a></p>
<div class="section" id="configuration-options">
<h2>Configuration Options<a class="headerlink" href="#configuration-options" title="Permalink to this headline">¶</a></h2>
<p>This feature supports several options.  This example shows what is possible,
we will cover them in detail below:</p>
<div class="highlight-yaml"><div class="highlight"><pre><span></span>web:
  register:
    enabled: true,
    uri: &#39;/signup&#39;,  # Use a different URL
    nextUri: &#39;/&#39;,    # Where to send the user to, if auto login is enabled
    form:
      fields: # see next section for documentation
      fieldOrder: # see next section
</pre></div>
</div>
</div>
<div class="section" id="modifying-default-fields">
<h2>Modifying Default Fields<a class="headerlink" href="#modifying-default-fields" title="Permalink to this headline">¶</a></h2>
<p>The registration form will render these fields by default, and they will be
required by the user:</p>
<ul class="simple">
<li>given_name</li>
<li>surname</li>
<li>email</li>
<li>password</li>
</ul>
<p>While email and password will always be required, you do not need to require
first and last name.  These can be configured as optional fields, or omitted
entirely.  You can also specify your own custom fields.  We&#8217;ll cover each use
case in detail.</p>
<div class="section" id="configure-first-name-and-last-name-as-optional">
<h3>Configure First Name and Last Name as Optional<a class="headerlink" href="#configure-first-name-and-last-name-as-optional" title="Permalink to this headline">¶</a></h3>
<p>If you would like to show the fields for first name and last name, but not
require them, you can set required to false:</p>
<div class="highlight-yaml"><div class="highlight"><pre><span></span><span class="l l-Scalar l-Scalar-Plain">web</span><span class="p p-Indicator">:</span>
  <span class="l l-Scalar l-Scalar-Plain">register</span><span class="p p-Indicator">:</span>
    <span class="l l-Scalar l-Scalar-Plain">form</span><span class="p p-Indicator">:</span>
      <span class="l l-Scalar l-Scalar-Plain">fields</span><span class="p p-Indicator">:</span>
        <span class="l l-Scalar l-Scalar-Plain">givenName</span><span class="p p-Indicator">:</span>
          <span class="l l-Scalar l-Scalar-Plain">required</span><span class="p p-Indicator">:</span> <span class="l l-Scalar l-Scalar-Plain">false</span>
        <span class="l l-Scalar l-Scalar-Plain">surname</span><span class="p p-Indicator">:</span>
          <span class="l l-Scalar l-Scalar-Plain">required</span><span class="p p-Indicator">:</span> <span class="l l-Scalar l-Scalar-Plain">false</span>
</pre></div>
</div>
<p>Because the Stormpath API requires a first name and last name, we will auto-fill
these fields with <cite>UNKNOWN</cite> if the user does not provide them.</p>
</div>
<div class="section" id="disabling-first-name-and-last-name">
<h3>Disabling First Name and Last Name<a class="headerlink" href="#disabling-first-name-and-last-name" title="Permalink to this headline">¶</a></h3>
<p>If you want to remove these fields entirely, you can set enabled to false:</p>
<div class="highlight-yaml"><div class="highlight"><pre><span></span><span class="l l-Scalar l-Scalar-Plain">web</span><span class="p p-Indicator">:</span>
  <span class="l l-Scalar l-Scalar-Plain">register</span><span class="p p-Indicator">:</span>
    <span class="l l-Scalar l-Scalar-Plain">form</span><span class="p p-Indicator">:</span>
      <span class="l l-Scalar l-Scalar-Plain">fields</span><span class="p p-Indicator">:</span>
        <span class="l l-Scalar l-Scalar-Plain">givenName</span><span class="p p-Indicator">:</span>
          <span class="l l-Scalar l-Scalar-Plain">enabled</span><span class="p p-Indicator">:</span> <span class="l l-Scalar l-Scalar-Plain">false</span>
        <span class="l l-Scalar l-Scalar-Plain">surname</span><span class="p p-Indicator">:</span>
          <span class="l l-Scalar l-Scalar-Plain">enabled</span><span class="p p-Indicator">:</span> <span class="l l-Scalar l-Scalar-Plain">false</span>
</pre></div>
</div>
<p>Because the Stormpath API requires a first name and last name, we will auto-fill
these fields with <cite>UNKNOWN</cite> when a user registers.</p>
</div>
</div>
<div class="section" id="creating-custom-fields">
<span id="custom-form-fields"></span><h2>Creating Custom Fields<a class="headerlink" href="#creating-custom-fields" title="Permalink to this headline">¶</a></h2>
<p>You can add your own custom fields to the form.  The values will be
automatically added to the user&#8217;s custom data object when they register
successfully. You can define a custom field by defining a new field object,
like this:</p>
<div class="highlight-yaml"><div class="highlight"><pre><span></span>web:
  register:
    form:
      fields:
        favoriteColor:
          enabled: true,
          label: &#39;Favorite Color&#39;,
          placeholder: &#39;E.g. Red, Blue&#39;,
          required: true,
          type: &#39;text&#39;
</pre></div>
</div>
<p>All field objects have the following properties, which must be defined:</p>
<ul class="simple">
<li><strong>enabled</strong> - Determines if the field is shown on the form.</li>
<li><strong>label</strong> - The text label that is shown to the left of the input field.</li>
<li><strong>placeholder</strong> - The help text that is shown inside the input field, if the
input field is empty (HTML5 property).</li>
<li><strong>required</strong> - Marks the field as a required field.  This uses the HTML5
required property, to prompt the user to enter the value.  The post data will
also be validated to ensure that the field is supplied, and an error will be
returned if the field is empty.</li>
<li><strong>type</strong> - the HTML type of the input, e.g. text, email, or password.</li>
</ul>
<div class="admonition note">
<p class="first admonition-title">Note</p>
<p class="last">The property name of the field definition, in this case <code class="docutils literal"><span class="pre">favoriteColor</span></code>,
will be used for the <code class="docutils literal"><span class="pre">name</span></code> attribute in the rendered HTML form, or the key
in the JSON view model for the registration endpoint.</p>
</div>
</div>
<div class="section" id="changing-field-order">
<h2>Changing Field Order<a class="headerlink" href="#changing-field-order" title="Permalink to this headline">¶</a></h2>
<p>If you want to change the order of the fields, you can do so by specifying the
<code class="docutils literal"><span class="pre">fieldOrder</span></code> array:</p>
<div class="highlight-yaml"><div class="highlight"><pre><span></span><span class="l l-Scalar l-Scalar-Plain">web</span><span class="p p-Indicator">:</span>
  <span class="l l-Scalar l-Scalar-Plain">register</span><span class="p p-Indicator">:</span>
    <span class="l l-Scalar l-Scalar-Plain">form</span><span class="p p-Indicator">:</span>
      <span class="l l-Scalar l-Scalar-Plain">fieldOrder</span><span class="p p-Indicator">:</span>
        <span class="p p-Indicator">-</span> <span class="s">&#39;givenName&#39;</span>
        <span class="p p-Indicator">-</span> <span class="s">&#39;surname&#39;</span>
        <span class="p p-Indicator">-</span> <span class="s">&#39;email&#39;</span>
        <span class="p p-Indicator">-</span> <span class="s">&#39;password&#39;</span>
        <span class="p p-Indicator">-</span> <span class="s">&#39;confirmPassword&#39;</span>
</pre></div>
</div>
</div>
<div class="section" id="password-strength-rules">
<h2>Password Strength Rules<a class="headerlink" href="#password-strength-rules" title="Permalink to this headline">¶</a></h2>
<p>Stormpath supports complex password strength rules, such as number of letters
or special characters required.  These settings are controlled on a directory
basis.  If you want to modify the password strength rules for your application
you should use the <a class="reference external" href="https://api.stormpath.com">Stormpath Admin Console</a> to find the directory that is mapped
to your application, and modify it&#8217;s password policy.</p>
<p>For more information see <a class="reference external" href="https://docs.stormpath.com/rest/product-guide/#account-password-strength-policy">Account Password Strength Policy</a>.</p>
</div>
<div class="section" id="email-verification">
<span id="id2"></span><h2>Email Verification<a class="headerlink" href="#email-verification" title="Permalink to this headline">¶</a></h2>
<p>We <strong>highly</strong> recommend that you use email verification, as it adds a layer
of security to your site (it makes it harder for bots to create spam accounts).</p>
<p>One of our favorite Stormpath features is email verification.  When this workflow
is enabled on the directory, we will send the new account an email with a link
that they must click on in order to verify their account.  When they click on
that link they will need to be directed to this URL:</p>
<p><a class="reference external" href="http://localhost:3000/verify?sptoken=TOKEN">http://localhost:3000/verify?sptoken=TOKEN</a></p>
<p>We have to configure our directory in order for this to happen. Use the
<a class="reference external" href="https://api.stormpath.com">Stormpath Admin Console</a> to find the directory of your application, then
go into the Workflows section.  In there you will find the email verification
workflow, which should be enabled by default (enable it if not).  Then modify
the template of the email to use this value for the <cite>Link Base URL</cite>:</p>
<div class="highlight-sh"><div class="highlight"><pre><span></span>http://localhost:3000/verify
</pre></div>
</div>
<p>When the user arrives on the verification URL, we will verify that their email
link is valid and hasn&#8217;t already been used.  If the link is valid we will redirect
them to the login page.  If there is a problem with the link we provide a form
that allows them to ask for a new link.</p>
</div>
<div class="section" id="auto-login">
<h2>Auto Login<a class="headerlink" href="#auto-login" title="Permalink to this headline">¶</a></h2>
<p>If you are <em>not</em> using email verificaion (not recommended) you may log users in
automatically when they register.  This can be achieved with this config:</p>
<div class="highlight-yaml"><div class="highlight"><pre><span></span><span class="l l-Scalar l-Scalar-Plain">web</span><span class="p p-Indicator">:</span>
  <span class="l l-Scalar l-Scalar-Plain">register</span><span class="p p-Indicator">:</span>
    <span class="l l-Scalar l-Scalar-Plain">autoLogin</span><span class="p p-Indicator">:</span> <span class="l l-Scalar l-Scalar-Plain">true,</span>
    <span class="l l-Scalar l-Scalar-Plain">nextUri</span><span class="p p-Indicator">:</span> <span class="s">&#39;/&#39;</span>
</pre></div>
</div>
<p>By default the nextUri is to the <code class="docutils literal"><span class="pre">/</span></code> page, but you can modify this.</p>
</div>
<div class="section" id="overriding-registration">
<h2>Overriding Registration<a class="headerlink" href="#overriding-registration" title="Permalink to this headline">¶</a></h2>
<div class="section" id="controllers">
<h3>Controllers<a class="headerlink" href="#controllers" title="Permalink to this headline">¶</a></h3>
<p>Since Stormpath controllers are highly configurable, they have lots of configuration code and are not written in a traditional way.</p>
<p>A RegisterController would usually have two actions - new &amp; create, however in Stormpath-Rails they are separated into two single action controllers - <code class="docutils literal"><span class="pre">Stormpath::Rails::Register::NewController</span></code> and <code class="docutils literal"><span class="pre">Stormpath::Rails::Register::CreateController</span></code>.
They both respond to a <code class="docutils literal"><span class="pre">call</span></code> method (action).</p>
<p>To override a Stormpath controller, first you need to subclass it:</p>
<div class="highlight-ruby"><div class="highlight"><pre><span></span><span class="k">class</span> <span class="nc">CreateAccountController</span> <span class="o">&lt;</span> <span class="no">Stormpath</span><span class="o">::</span><span class="no">Rails</span><span class="o">::</span><span class="no">Register</span><span class="o">::</span><span class="no">CreateController</span>
<span class="k">end</span>
</pre></div>
</div>
<p>and update the routes to point to your new controller:</p>
<div class="highlight-ruby"><div class="highlight"><pre><span></span><span class="no">Rails</span><span class="o">.</span><span class="n">application</span><span class="o">.</span><span class="n">routes</span><span class="o">.</span><span class="n">draw</span> <span class="k">do</span>
  <span class="n">stormpath_rails_routes</span><span class="p">(</span><span class="ss">actions</span><span class="p">:</span> <span class="p">{</span>
    <span class="s1">&#39;register#create&#39;</span> <span class="o">=&gt;</span> <span class="s1">&#39;create_account#call&#39;</span>
  <span class="p">})</span>
<span class="k">end</span>
</pre></div>
</div>
</div>
</div>
<div class="section" id="routes">
<h2>Routes<a class="headerlink" href="#routes" title="Permalink to this headline">¶</a></h2>
<p>To override routes (while using Stormpath default controllers), please use the configuration file <code class="docutils literal"><span class="pre">config/stormpath.yml</span></code> and override them there.
As usual, to see what the routes are, run <em>rake routes</em>.</p>
</div>
<div class="section" id="views">
<h2>Views<a class="headerlink" href="#views" title="Permalink to this headline">¶</a></h2>
<p>You can use the Stormpath views generator to copy the default views to your application for modification:</p>
<div class="highlight-ruby"><div class="highlight"><pre><span></span><span class="n">rails</span> <span class="n">generate</span> <span class="ss">stormpath</span><span class="p">:</span><span class="n">views</span>
</pre></div>
</div>
<p>which generates these files:</p>
<div class="highlight-javascript"><div class="highlight"><pre><span></span><span class="nx">stormpath</span><span class="o">/</span><span class="nx">rails</span><span class="o">/</span><span class="nx">layouts</span><span class="o">/</span><span class="nx">stormpath</span><span class="p">.</span><span class="nx">html</span><span class="p">.</span><span class="nx">erb</span>

<span class="nx">stormpath</span><span class="o">/</span><span class="nx">rails</span><span class="o">/</span><span class="nx">login</span><span class="o">/</span><span class="k">new</span><span class="p">.</span><span class="nx">html</span><span class="p">.</span><span class="nx">erb</span>
<span class="nx">stormpath</span><span class="o">/</span><span class="nx">rails</span><span class="o">/</span><span class="nx">login</span><span class="o">/</span><span class="nx">_form</span><span class="p">.</span><span class="nx">html</span><span class="p">.</span><span class="nx">erb</span>

<span class="nx">stormpath</span><span class="o">/</span><span class="nx">rails</span><span class="o">/</span><span class="nx">register</span><span class="o">/</span><span class="k">new</span><span class="p">.</span><span class="nx">html</span><span class="p">.</span><span class="nx">erb</span>
<span class="nx">stormpath</span><span class="o">/</span><span class="nx">rails</span><span class="o">/</span><span class="nx">register</span><span class="o">/</span><span class="nx">_form</span><span class="p">.</span><span class="nx">html</span><span class="p">.</span><span class="nx">erb</span>

<span class="nx">stormpath</span><span class="o">/</span><span class="nx">rails</span><span class="o">/</span><span class="nx">change_password</span><span class="o">/</span><span class="k">new</span><span class="p">.</span><span class="nx">html</span><span class="p">.</span><span class="nx">erb</span>

<span class="nx">stormpath</span><span class="o">/</span><span class="nx">rails</span><span class="o">/</span><span class="nx">forgot_password</span><span class="o">/</span><span class="k">new</span><span class="p">.</span><span class="nx">html</span><span class="p">.</span><span class="nx">erb</span>

<span class="nx">stormpath</span><span class="o">/</span><span class="nx">rails</span><span class="o">/</span><span class="nx">shared</span><span class="o">/</span><span class="nx">_input</span><span class="p">.</span><span class="nx">html</span><span class="p">.</span><span class="nx">erb</span>

<span class="nx">stormpath</span><span class="o">/</span><span class="nx">rails</span><span class="o">/</span><span class="nx">verify_email</span><span class="o">/</span><span class="k">new</span><span class="p">.</span><span class="nx">html</span><span class="p">.</span><span class="nx">erb</span>
</pre></div>
</div>
</div>
<div class="section" id="json-registration-api">
<h2>JSON Registration API<a class="headerlink" href="#json-registration-api" title="Permalink to this headline">¶</a></h2>
<p>If you are using this gem from a SPA framework like Angular or React, you
will want to make a JSON post to register users.  Simply post an object to
<code class="docutils literal"><span class="pre">/register</span></code> that looks like this, and supply the fields that you wish to
populate on the user:</p>
<div class="highlight-javascript"><div class="highlight"><pre><span></span><span class="p">{</span>
    <span class="s2">&quot;email&quot;</span><span class="o">:</span> <span class="s2">&quot;foo@bar.com&quot;</span><span class="p">,</span>
    <span class="s2">&quot;password&quot;</span><span class="o">:</span> <span class="s2">&quot;mySuper3ecretPAssw0rd&quot;</span><span class="p">,</span>
    <span class="s2">&quot;surname&quot;</span><span class="o">:</span> <span class="s2">&quot;optional&quot;</span>
<span class="p">}</span>
</pre></div>
</div>
<p>If the user is created successfully you will get a 200 response and the body
will the the account object that was created.  If there was an error you
will get an object that looks like <code class="docutils literal"><span class="pre">{</span> <span class="pre">message:</span> <span class="pre">'error</span> <span class="pre">message</span> <span class="pre">here'}</span></code>.</p>
<p>If you make a GET request to the registration endpoint, with <code class="docutils literal"><span class="pre">Accept:</span>
<span class="pre">application/json</span></code>, we will send you a JSON view model that describes the
registration form and the social account stores that are mapped to your
Stormpath Application.  Here is an example view model that shows you an
application that has a default registration form, and a mapped Google
directory:</p>
<div class="highlight-javascript"><div class="highlight"><pre><span></span><span class="p">{</span>
  <span class="s2">&quot;accountStores&quot;</span><span class="o">:</span> <span class="p">[</span>
    <span class="p">{</span>
      <span class="s2">&quot;name&quot;</span><span class="o">:</span> <span class="s2">&quot;stormpath-rails google&quot;</span><span class="p">,</span>
      <span class="s2">&quot;href&quot;</span><span class="o">:</span> <span class="s2">&quot;https://api.stormpath.com/v1/directories/gc0Ty90yXXk8ifd2QPwt&quot;</span><span class="p">,</span>
      <span class="s2">&quot;provider&quot;</span><span class="o">:</span> <span class="p">{</span>
        <span class="s2">&quot;providerId&quot;</span><span class="o">:</span> <span class="s2">&quot;google&quot;</span><span class="p">,</span>
        <span class="s2">&quot;clientId&quot;</span><span class="o">:</span> <span class="s2">&quot;441084632428-9au0gijbo5icagep9u79qtf7ic7cc5au.apps.googleusercontent.com&quot;</span><span class="p">,</span>
        <span class="s2">&quot;scope&quot;</span><span class="o">:</span> <span class="s2">&quot;email profile&quot;</span><span class="p">,</span>
        <span class="s2">&quot;href&quot;</span><span class="o">:</span> <span class="s2">&quot;https://api.stormpath.com/v1/directories/gc0Ty90yXXk8ifd2QPwt/provider&quot;</span>
      <span class="p">}</span>
    <span class="p">}</span>
  <span class="p">],</span>
  <span class="s2">&quot;form&quot;</span><span class="o">:</span> <span class="p">{</span>
    <span class="s2">&quot;fields&quot;</span><span class="o">:</span> <span class="p">[</span>
      <span class="p">{</span>
        <span class="s2">&quot;label&quot;</span><span class="o">:</span> <span class="s2">&quot;First Name&quot;</span><span class="p">,</span>
        <span class="s2">&quot;placeholder&quot;</span><span class="o">:</span> <span class="s2">&quot;First Name&quot;</span><span class="p">,</span>
        <span class="s2">&quot;required&quot;</span><span class="o">:</span> <span class="kc">true</span><span class="p">,</span>
        <span class="s2">&quot;type&quot;</span><span class="o">:</span> <span class="s2">&quot;text&quot;</span><span class="p">,</span>
        <span class="s2">&quot;name&quot;</span><span class="o">:</span> <span class="s2">&quot;givenName&quot;</span>
      <span class="p">},</span>
      <span class="p">{</span>
        <span class="s2">&quot;label&quot;</span><span class="o">:</span> <span class="s2">&quot;Last Name&quot;</span><span class="p">,</span>
        <span class="s2">&quot;placeholder&quot;</span><span class="o">:</span> <span class="s2">&quot;Last Name&quot;</span><span class="p">,</span>
        <span class="s2">&quot;required&quot;</span><span class="o">:</span> <span class="kc">true</span><span class="p">,</span>
        <span class="s2">&quot;type&quot;</span><span class="o">:</span> <span class="s2">&quot;text&quot;</span><span class="p">,</span>
        <span class="s2">&quot;name&quot;</span><span class="o">:</span> <span class="s2">&quot;surname&quot;</span>
      <span class="p">},</span>
      <span class="p">{</span>
        <span class="s2">&quot;label&quot;</span><span class="o">:</span> <span class="s2">&quot;Email&quot;</span><span class="p">,</span>
        <span class="s2">&quot;placeholder&quot;</span><span class="o">:</span> <span class="s2">&quot;Email&quot;</span><span class="p">,</span>
        <span class="s2">&quot;required&quot;</span><span class="o">:</span> <span class="kc">true</span><span class="p">,</span>
        <span class="s2">&quot;type&quot;</span><span class="o">:</span> <span class="s2">&quot;email&quot;</span><span class="p">,</span>
        <span class="s2">&quot;name&quot;</span><span class="o">:</span> <span class="s2">&quot;email&quot;</span>
      <span class="p">},</span>
      <span class="p">{</span>
        <span class="s2">&quot;label&quot;</span><span class="o">:</span> <span class="s2">&quot;Password&quot;</span><span class="p">,</span>
        <span class="s2">&quot;placeholder&quot;</span><span class="o">:</span> <span class="s2">&quot;Password&quot;</span><span class="p">,</span>
        <span class="s2">&quot;required&quot;</span><span class="o">:</span> <span class="kc">true</span><span class="p">,</span>
        <span class="s2">&quot;type&quot;</span><span class="o">:</span> <span class="s2">&quot;password&quot;</span><span class="p">,</span>
        <span class="s2">&quot;name&quot;</span><span class="o">:</span> <span class="s2">&quot;password&quot;</span>
      <span class="p">}</span>
    <span class="p">]</span>
  <span class="p">}</span>
<span class="p">}</span>
</pre></div>
</div>
<div class="admonition note">
<p class="first admonition-title">Note</p>
<p class="last">You may have to explicitly tell your client library that you want a JSON
response from the server. Not all libraries do this automatically. If the
library does not set the <code class="docutils literal"><span class="pre">Accept:</span> <span class="pre">application/json</span></code> header on the request,
you&#8217;ll get back the HTML registration form - not the JSON response that you
expect.</p>
</div>
</div>
</div>


           </div>
          </div>
          <footer>
  
    <div class="rst-footer-buttons" role="navigation" aria-label="footer navigation">
      
        <a href="login.html" class="btn btn-neutral float-right" title="Login" accesskey="n">Next <span class="fa fa-arrow-circle-right"></span></a>
      
      
        <a href="authentication.html" class="btn btn-neutral" title="Authentication" accesskey="p"><span class="fa fa-arrow-circle-left"></span> Previous</a>
      
    </div>
  

  <hr/>

  <div role="contentinfo">
    <p>
        &copy; Copyright 2016, Stormpath, Inc..

    </p>
  </div>
  Built with <a href="http://sphinx-doc.org/">Sphinx</a> using a <a href="https://github.com/snide/sphinx_rtd_theme">theme</a> provided by <a href="https://readthedocs.org">Read the Docs</a>. 

</footer>

        </div>
      </div>

    </section>

  </div>
  


  

    <script type="text/javascript">
        var DOCUMENTATION_OPTIONS = {
            URL_ROOT:'./',
            VERSION:'0.1',
            COLLAPSE_INDEX:false,
            FILE_SUFFIX:'.html',
            HAS_SOURCE:  true
        };
    </script>
      <script type="text/javascript" src="_static/jquery.js"></script>
      <script type="text/javascript" src="_static/underscore.js"></script>
      <script type="text/javascript" src="_static/doctools.js"></script>

  

  
  
    <script type="text/javascript" src="_static/js/theme.js"></script>
  

  
  
  <script type="text/javascript">
      jQuery(function () {
          SphinxRtdTheme.StickyNav.enable();
      });
  </script>
  
   
  <script src="//cdn.optimizely.com/js/225847041.js"></script>


  

</body>
</html>