

<!DOCTYPE html>
<!--[if IE 8]><html class="no-js lt-ie9" lang="en" > <![endif]-->
<!--[if gt IE 8]><!--> <html class="no-js" lang="en" > <!--<![endif]-->
<head>
  <meta charset="utf-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  
  <title>Access Control &mdash; Stormpath Shiro Servlet Plugin 0.7.0 documentation</title>
  

  
  

  
  <link href='https://fonts.googleapis.com/css?family=Lato:400,700,400italic,700italic|Roboto+Slab:400,700|Inconsolata:400,700' rel='stylesheet' type='text/css'>

  
  
    

  

  
  
    <link rel="stylesheet" href="_static/css/theme.css" type="text/css" />
  

  
        <link rel="author" title="About these documents"
              href="about.html"/>
    <link rel="top" title="Stormpath Shiro Servlet Plugin 0.7.0 documentation" href="index.html"/>
        <link rel="next" title="Internationalization (i18n)" href="i18n.html"/>
        <link rel="prev" title="Request Context" href="request.html"/> 

  
  <script src="https://cdnjs.cloudflare.com/ajax/libs/modernizr/2.6.2/modernizr.min.js"></script>

</head>

<body class="wy-body-for-nav" role="document">

  <div class="wy-grid-for-nav">

    
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-nav-search">
        <a href="index.html" class="fa fa-home"> Stormpath Shiro Servlet Plugin</a>
        <div role="search">
  <form id ="rtd-search-form" class="wy-form" action="search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>
      </div>

      <div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="main navigation">
        
        
            <ul class="current">
<li class="toctree-l1"><a class="reference internal" href="about.html">About</a><ul>
<li class="toctree-l2"><a class="reference internal" href="about.html#what-is-stormpath">What is Stormpath?</a></li>
<li class="toctree-l2"><a class="reference internal" href="about.html#what-is-apache-shiro">What is Apache Shiro?</a></li>
<li class="toctree-l2"><a class="reference internal" href="about.html#what-is-the-project">What is the Stormpath Shiro Servlet Plugin?</a></li>
<li class="toctree-l2"><a class="reference internal" href="about.html#who-should-use-stormpath">Who should use Stormpath?</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="quickstart.html">Quickstart</a><ul>
<li class="toctree-l2"><a class="reference internal" href="quickstart.html#get-an-api-key">Get an API Key</a></li>
<li class="toctree-l2"><a class="reference internal" href="quickstart.html#add-the-project">Add the Stormpath Shiro Servlet Plugin</a></li>
<li class="toctree-l2"><a class="reference internal" href="quickstart.html#try-it">Try it!</a></li>
<li class="toctree-l2"><a class="reference internal" href="quickstart.html#next-steps">Next Steps</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="config.html">Configuration</a><ul>
<li class="toctree-l2"><a class="reference internal" href="config.html#no-config">No Config?</a></li>
<li class="toctree-l2"><a class="reference internal" href="config.html#web-xml">web.xml</a></li>
<li class="toctree-l2"><a class="reference internal" href="config.html#stormpath-properties">Stormpath Properties</a></li>
<li class="toctree-l2"><a class="reference internal" href="config.html#sdk-client">SDK Client</a></li>
<li class="toctree-l2"><a class="reference internal" href="config.html#stormpath-application">Stormpath Application</a></li>
<li class="toctree-l2"><a class="reference internal" href="config.html#filters">Filters</a></li>
<li class="toctree-l2"><a class="reference internal" href="config.html#advanced-apache-shiro-configuration">Advanced Apache Shiro Configuration</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="registration.html">Registration</a><ul>
<li class="toctree-l2"><a class="reference internal" href="registration.html#overview">Overview</a></li>
<li class="toctree-l2"><a class="reference internal" href="registration.html#uri">URI</a></li>
<li class="toctree-l2"><a class="reference internal" href="registration.html#next-uri">Next URI</a></li>
<li class="toctree-l2"><a class="reference internal" href="registration.html#form-fields">Form Fields</a></li>
<li class="toctree-l2"><a class="reference internal" href="registration.html#i18n">i18n</a></li>
<li class="toctree-l2"><a class="reference internal" href="registration.html#email-verification">Email Verification</a></li>
<li class="toctree-l2"><a class="reference internal" href="registration.html#events">Events</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="login.html">Login</a><ul>
<li class="toctree-l2"><a class="reference internal" href="login.html#overview">Overview</a></li>
<li class="toctree-l2"><a class="reference internal" href="login.html#security-notice">Security Notice</a></li>
<li class="toctree-l2"><a class="reference internal" href="login.html#uri">URI</a></li>
<li class="toctree-l2"><a class="reference internal" href="login.html#next-uri">Next URI</a></li>
<li class="toctree-l2"><a class="reference internal" href="login.html#i18n">i18n</a></li>
<li class="toctree-l2"><a class="reference internal" href="login.html#events">Events</a></li>
<li class="toctree-l2"><a class="reference internal" href="login.html#authentication-state">Authentication State</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="social.html">Social Login</a><ul>
<li class="toctree-l2"><a class="reference internal" href="social.html#facebook-login">Facebook Login</a></li>
<li class="toctree-l2"><a class="reference internal" href="social.html#google-login">Google Login</a></li>
<li class="toctree-l2"><a class="reference internal" href="social.html#linkedin-login">LinkedIn Login</a></li>
<li class="toctree-l2"><a class="reference internal" href="social.html#json-api">JSON API</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="forgot-password.html">Forgot Password</a><ul>
<li class="toctree-l2"><a class="reference internal" href="forgot-password.html#overview">Overview</a></li>
<li class="toctree-l2"><a class="reference internal" href="forgot-password.html#configure-the-workflow">Configure the Workflow</a></li>
<li class="toctree-l2"><a class="reference internal" href="forgot-password.html#try-it">Try it!</a></li>
<li class="toctree-l2"><a class="reference internal" href="forgot-password.html#forgot-uri">Forgot URI</a></li>
<li class="toctree-l2"><a class="reference internal" href="forgot-password.html#forgot-next-uri">Forgot Next URI</a></li>
<li class="toctree-l2"><a class="reference internal" href="forgot-password.html#change-password-uri">Change Password URI</a></li>
<li class="toctree-l2"><a class="reference internal" href="forgot-password.html#change-password-next-uri">Change Password Next URI</a></li>
<li class="toctree-l2"><a class="reference internal" href="forgot-password.html#i18n">i18n</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="logout.html">Logout</a><ul>
<li class="toctree-l2"><a class="reference internal" href="logout.html#uri">URI</a></li>
<li class="toctree-l2"><a class="reference internal" href="logout.html#next-uri">Next URI</a></li>
<li class="toctree-l2"><a class="reference internal" href="logout.html#events">Events</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="http-request-authentication.html">HTTP Request Authentication</a><ul>
<li class="toctree-l2"><a class="reference internal" href="http-request-authentication.html#http-basic-authentication">HTTP Basic Authentication</a></li>
<li class="toctree-l2"><a class="reference internal" href="http-request-authentication.html#token-authentication">Token Authentication</a></li>
<li class="toctree-l2"><a class="reference internal" href="http-request-authentication.html#api-key-authentication">API Key Authentication</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="request.html">Request Context</a><ul>
<li class="toctree-l2"><a class="reference internal" href="request.html#current-user-account">Current User Account</a></li>
<li class="toctree-l2"><a class="reference internal" href="request.html#stormpath-application">Stormpath Application</a></li>
<li class="toctree-l2"><a class="reference internal" href="request.html#stormpath-sdk-client">Stormpath SDK Client</a></li>
</ul>
</li>
<li class="toctree-l1 current"><a class="current reference internal" href="">Access Control</a><ul>
<li class="toctree-l2"><a class="reference internal" href="#authentication-authorization">Authentication &amp; Authorization</a></li>
<li class="toctree-l2"><a class="reference internal" href="#groups-are-roles">Groups are Roles</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="#permissions-as-custom-user-data">Permissions as Custom User Data</a></li>
<li class="toctree-l1"><a class="reference internal" href="i18n.html">Internationalization (i18n)</a><ul>
<li class="toctree-l2"><a class="reference internal" href="i18n.html#languages">Languages</a></li>
<li class="toctree-l2"><a class="reference internal" href="i18n.html#request-locale">Request Locale</a></li>
<li class="toctree-l2"><a class="reference internal" href="i18n.html#jsp-tag-library">JSP Tag Library</a></li>
<li class="toctree-l2"><a class="reference internal" href="i18n.html#i18n-properties">i18n.properties</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="events.html">Events</a><ul>
<li class="toctree-l2"><a class="reference internal" href="events.html#subscribe-to-events">Subscribe to Events</a></li>
<li class="toctree-l2"><a class="reference internal" href="events.html#id2">Events</a></li>
<li class="toctree-l2"><a class="reference internal" href="events.html#listener-best-practices">Listener Best Practices</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="caching.html">Caching</a><ul>
<li class="toctree-l2"><a class="reference internal" href="caching.html#caching-options">Caching Options</a></li>
<li class="toctree-l2"><a class="reference internal" href="caching.html#shared-cache">Shared Cache</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="views.html">Custom Views</a><ul>
<li class="toctree-l2"><a class="reference internal" href="views.html#jsp-views">JSP Views</a></li>
<li class="toctree-l2"><a class="reference internal" href="views.html#css">CSS</a></li>
<li class="toctree-l2"><a class="reference internal" href="views.html#internationalization-i18n">Internationalization (i18n)</a></li>
<li class="toctree-l2"><a class="reference internal" href="views.html#change-a-default-view">Change a Default View</a></li>
<li class="toctree-l2"><a class="reference internal" href="views.html#view-template">View Template</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="tutorial.html">Tutorial</a><ul>
<li class="toctree-l2"><a class="reference internal" href="tutorial.html#get-an-api-key">Get an API Key</a></li>
<li class="toctree-l2"><a class="reference internal" href="tutorial.html#secure-the-application">Secure the Application</a></li>
<li class="toctree-l2"><a class="reference internal" href="tutorial.html#using-roles">Using Roles</a></li>
<li class="toctree-l2"><a class="reference internal" href="tutorial.html#using-permissions">Using Permissions</a></li>
<li class="toctree-l2"><a class="reference internal" href="tutorial.html#wrapping-things-up">Wrapping Things Up</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="appendix.html">Appendix</a></li>
</ul>

        
      </div>
      &nbsp;
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap">

      
      <nav class="wy-nav-top" role="navigation" aria-label="top navigation">
        <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
        <a href="index.html">Stormpath Shiro Servlet Plugin</a>
      </nav>


      
      <div class="wy-nav-content">
        <div class="rst-content">
          <div role="navigation" aria-label="breadcrumbs navigation">
  <ul class="wy-breadcrumbs">
    <li><a href="index.html">Docs</a> &raquo;</li>
      
    <li>Access Control</li>
      <li class="wy-breadcrumbs-aside">
        
          <a href="_sources/access-control.txt" rel="nofollow"> View page source</a>
        
      </li>
  </ul>
  <hr/>
</div>
          <div role="main">
            
  <div class="section" id="access-control">
<span id="id1"></span><h1>Access Control<a class="headerlink" href="#access-control" title="Permalink to this headline">¶</a></h1>
<p>The Stormpath Shiro Servlet Plugin uses both the <a class="reference external" href="https://docs.stormpath.com/java/servlet-plugin/">Stormpath Java Servlet Plugin</a> and <a class="reference external" href="http://shiro.apache.org/web.html#Web-WebINIconfiguration">Apache Shiro&#8217;s web</a> module.
The Stormpath filters will execute before the Shiro filters, this is done to make use of Stormpath&#8217;s login and registration workflows (including <a class="reference external" href="social.rst">Social Login</a> and ID Site), and still allow
defining Shiro&#8217;s authentication an authorization filters to function as expected.</p>
<div class="section" id="authentication-authorization">
<h2>Authentication &amp; Authorization<a class="headerlink" href="#authentication-authorization" title="Permalink to this headline">¶</a></h2>
<p>Web applications using Apache Shiro typically define access permissions in a <code class="docutils literal"><span class="pre">[urls]</span></code> section in a <code class="docutils literal"><span class="pre">shiro.ini</span></code> file.</p>
<div class="highlight-ini"><div class="highlight"><pre><span></span>...
[urls]

/index.html = anon
/user/** = authc
/admin/** = authc, roles[administrator]
</pre></div>
</div>
<p>In this example, anybody is able to view the <code class="docutils literal"><span class="pre">index.html</span></code> page, any logged in user can access all resources under <code class="docutils literal"><span class="pre">/user/</span></code>, and finally any logged in user with the &#8216;administrator&#8217; role
can access all resources under <code class="docutils literal"><span class="pre">/admin/</span></code>.</p>
<p>For more details on this topic take a look at the <a class="reference external" href="http://shiro.apache.org/web.html#Web-WebINIconfiguration">Apache Shiro Documentation</a></p>
</div>
<div class="section" id="groups-are-roles">
<h2>Groups are Roles<a class="headerlink" href="#groups-are-roles" title="Permalink to this headline">¶</a></h2>
<p>Out of the box, groups assigned to a Stormpath account are mapped directly to Apache Shiro roles using the group&#8217;s <cite>href</cite>.  This behavior is configurable, one or more of
the following modes can be used:</p>
<table border="1" class="docutils">
<colgroup>
<col width="5%" />
<col width="40%" />
<col width="55%" />
</colgroup>
<thead valign="bottom">
<tr class="row-odd"><th class="head">Mode</th>
<th class="head">Behavior</th>
<th class="head">Example</th>
</tr>
</thead>
<tbody valign="top">
<tr class="row-even"><td>HREF</td>
<td>Returns the Group&#8217;s fully qualified HREF
as the role name</td>
<td><a class="reference external" href="https://api.stormpath.com/v1/groups/upXiExAmPlEfA5L1G5ZaSQ">https://api.stormpath.com/v1/groups/upXiExAmPlEfA5L1G5ZaSQ</a></td>
</tr>
<tr class="row-odd"><td>ID</td>
<td>Returns Group&#8217;s globally unique identifier
as the role name</td>
<td>upXiExAmPlEfA5L1G5ZaSQ</td>
</tr>
<tr class="row-even"><td>NAME</td>
<td>Returns Group&#8217;s name as the role name</td>
<td>administrators</td>
</tr>
</tbody>
</table>
<p>This configuration can be set in the <cite>main</cite> section of your <cite>shiro.ini</cite></p>
<div class="highlight-ini"><div class="highlight"><pre><span></span>[main]
...
stormpathRealm.groupRoleResolver.modeNames = href, id
</pre></div>
</div>
<p>In the above configuration, each Group translates into two Shiro role names: one role name is the raw href itself,
the other role name is the Group ID. You can specify one or more modes to translate into one or more role names respectively. Mode names are case-insensitive.</p>
<p><strong>NOTE:</strong> Group Names, while easier to read in code, can change at any time via a REST API call or by using the Stormpath UI Console.
It is strongly recommended to use only the HREF or ID modes as these values will never change. Acquiring group names might also incur a REST server call, whereas the the HREF is guaranteed to be present.</p>
</div>
</div>
<div class="section" id="permissions-as-custom-user-data">
<h1>Permissions as Custom User Data<a class="headerlink" href="#permissions-as-custom-user-data" title="Permalink to this headline">¶</a></h1>
<p>Shiro <a class="reference external" href="http://shiro.apache.org/permissions.html">permission strings</a> can be stored via custom user data attached to a group or account.  Custom user data can be added
programmatically or by using the Stormpath Admin Console.</p>
<div class="highlight-java"><div class="highlight"><pre><span></span><span class="n">Account</span> <span class="n">account</span> <span class="o">=</span> <span class="n">getAccount</span><span class="o">();</span>
<span class="k">new</span> <span class="n">CustomDataPermissionsEditor</span><span class="o">(</span><span class="n">account</span><span class="o">.</span><span class="na">getCustomData</span><span class="o">())</span>
    <span class="o">.</span><span class="na">append</span><span class="o">(</span><span class="s">&quot;someResourceType:anIdentifier:anAction&quot;</span><span class="o">)</span>
    <span class="o">.</span><span class="na">append</span><span class="o">(</span><span class="s">&quot;anotherResourceType:anIdentifier:*&quot;</span><span class="o">)</span>
    <span class="o">.</span><span class="na">remove</span><span class="o">(</span><span class="s">&quot;oldPermission&quot;</span><span class="o">);</span>
<span class="n">account</span><span class="o">.</span><span class="na">save</span><span class="o">();</span>
</pre></div>
</div>
<p>In the above example the permission string &#8216;oldPermission&#8217; is being removed while &#8216;someResourceType:anIdentifier:anAction&#8217;
and &#8216;anotherResourceType:anIdentifier:*&#8217; are being added.</p>
<p>These permissions can then be used in your code by calling:</p>
<div class="highlight-java"><div class="highlight"><pre><span></span><span class="n">subject</span><span class="o">.</span><span class="na">isPermitted</span><span class="o">(</span><span class="s">&quot;someResourceType:anIdentifier:anAction&quot;</span><span class="o">)</span>
</pre></div>
</div>
<p>Or mapped to a path in the <cite>[urls]</cite> section in your shiro.ini file:</p>
<div class="highlight-ini"><div class="highlight"><pre><span></span>...
[urls]
/application/path = perms[&quot;someResourceType:anIdentifier:anAction&quot;]
</pre></div>
</div>
</div>


          </div>
          <footer>
  
    <div class="rst-footer-buttons" role="navigation" aria-label="footer navigation">
      
        <a href="i18n.html" class="btn btn-neutral float-right" title="Internationalization (i18n)">Next <span class="fa fa-arrow-circle-right"></span></a>
      
      
        <a href="request.html" class="btn btn-neutral" title="Request Context"><span class="fa fa-arrow-circle-left"></span> Previous</a>
      
    </div>
  

  <hr/>

  <div role="contentinfo">
    <p>
        &copy; Copyright 2014, Stormpath, Inc..
    </p>
  </div>

  <a href="https://github.com/snide/sphinx_rtd_theme">Sphinx theme</a> provided by <a href="https://readthedocs.org">Read the Docs</a>
</footer>
        </div>
      </div>

    </section>

  </div>
  


  

    <script type="text/javascript">
        var DOCUMENTATION_OPTIONS = {
            URL_ROOT:'./',
            VERSION:'0.7.0',
            COLLAPSE_INDEX:false,
            FILE_SUFFIX:'.html',
            HAS_SOURCE:  true
        };
    </script>
      <script type="text/javascript" src="_static/jquery.js"></script>
      <script type="text/javascript" src="_static/underscore.js"></script>
      <script type="text/javascript" src="_static/doctools.js"></script>

  

  
  
    <script type="text/javascript" src="_static/js/theme.js"></script>
  

  
  
  <script type="text/javascript">
      jQuery(function () {
          SphinxRtdTheme.StickyNav.enable();
      });
  </script>
  
   
  <script>
    (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
        (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
            m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
    })(window,document,'script','//www.google-analytics.com/analytics.js','ga');
    ga('create', 'UA-29159574-1', 'auto');
    ga('send', 'pageview');
  </script>
  <script type="text/javascript">
    (function(d,s,i,r) {
        if (d.getElementById(i)){return;}
        var n=d.createElement(s),e=d.getElementsByTagName(s)[0];
        n.id=i;n.src='//js.hs-analytics.net/analytics/'+(Math.ceil(new Date()/r)*r)+'/475298.js';
        e.parentNode.insertBefore(n, e);
    })(document,"script","hs-analytics",300000);
  </script>
  <script type="text/javascript">
    var _kmq = _kmq || [];
    var _kmk = _kmk || '684b854336bd3a6523260ebd991eec06b18b929a';
    function _kms(u){
        setTimeout(function(){
            var d = document, f = d.getElementsByTagName('script')[0],
                    s = d.createElement('script');
            s.type = 'text/javascript'; s.async = true; s.src = u;
            f.parentNode.insertBefore(s, f);
        }, 1);
    }
    _kms('//i.kissmetrics.com/i.js');
    _kms('//doug1izaerwt3.cloudfront.net/' + _kmk + '.1.js');
  </script>
  <script src="//cdn.optimizely.com/js/225847041.js"></script>
  <script type="text/javascript" >
    $(document).ready(function() {
      $("a[href^='http']").attr('target','_blank');
    });
  </script>


</body>
</html>