

<!DOCTYPE html>
<!--[if IE 8]><html class="no-js lt-ie9" lang="en" > <![endif]-->
<!--[if gt IE 8]><!--> <html class="no-js" lang="en" > <!--<![endif]-->
<head>
  <meta charset="utf-8">
  
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  
  <title>Authentication &mdash; Express Library Guide 4.0.0 documentation</title>
  

  
  

  

  
  
    

  

  
  
    <link rel="stylesheet" href="_static/css/theme.css" type="text/css" />
  

  

  
        <link rel="index" title="Index"
              href="genindex.html"/>
        <link rel="search" title="Search" href="search.html"/>
    <link rel="top" title="Express Library Guide 4.0.0 documentation" href="index.html"/>
        <link rel="next" title="Authorization" href="authorization.html"/>
        <link rel="prev" title="User Data" href="user_data.html"/> 

  
  <script src="_static/js/modernizr.min.js"></script>

  
  <script src="https://cdn.optimizely.com/js/225847041.js"></script>

  
  <script>
  !function(f,b,e,v,n,t,s){if(f.fbq)return;n=f.fbq=function(){n.callMethod?
  n.callMethod.apply(n,arguments):n.queue.push(arguments)};if(!f._fbq)f._fbq=n;
  n.push=n;n.loaded=!0;n.version='2.0';n.queue=[];t=b.createElement(e);t.async=!0;
  t.src=v;s=b.getElementsByTagName(e)[0];s.parentNode.insertBefore(t,s)}(window,
  document,'script','https://connect.facebook.net/en_US/fbevents.js');
  fbq('init', '986262161469311');
  fbq('track', 'PageView');
  </script>
  <noscript><img height="1" width="1" style="display:none"
  src="https://www.facebook.com/tr?id=986262161469311&ev=PageView&noscript=1"
  /></noscript>
</head>

<body class="wy-body-for-nav" role="document">

  
  <noscript><iframe src="//www.googletagmanager.com/ns.html?id=GTM-NQZZFW"
  height="0" width="0" style="display:none;visibility:hidden"></iframe></noscript>
  <script>(function(w,d,s,l,i){w[l]=w[l]||[];w[l].push({'gtm.start':
  new Date().getTime(),event:'gtm.js'});var f=d.getElementsByTagName(s)[0],
  j=d.createElement(s),dl=l!='dataLayer'?'&l='+l:'';j.async=true;j.src=
  '//www.googletagmanager.com/gtm.js?id='+i+dl;f.parentNode.insertBefore(j,f);
  })(window,document,'script','dataLayer','GTM-NQZZFW');</script>

   
  <div class="wy-grid-for-nav">

    
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-scroll">
        <div class="wy-side-nav-search">
          

          
            <a href="index.html" class="icon icon-home"> Express Library Guide
          

          
          </a>

          

          
<div role="search">
  <form id="rtd-search-form" class="wy-form" action="search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>

          
        </div>

        <div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="main navigation">
          
            
            
                <ul class="current">
<li class="toctree-l1"><a class="reference internal" href="introduction.html">Introduction</a><ul>
<li class="toctree-l2"><a class="reference internal" href="introduction.html#what-does-this-library-do">What does this library do?</a></li>
<li class="toctree-l2"><a class="reference internal" href="introduction.html#what-is-stormpath">What is Stormpath?</a></li>
<li class="toctree-l2"><a class="reference internal" href="introduction.html#who-should-use-stormpath">Who Should Use Stormpath</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="setup.html">Setup</a><ul>
<li class="toctree-l2"><a class="reference internal" href="setup.html#create-a-stormpath-account">Create a Stormpath Account</a></li>
<li class="toctree-l2"><a class="reference internal" href="setup.html#create-an-api-key-pair">Create an API Key Pair</a></li>
<li class="toctree-l2"><a class="reference internal" href="setup.html#find-your-stormpath-application">Find Your Stormpath Application</a></li>
<li class="toctree-l2"><a class="reference internal" href="setup.html#install-the-package">Install the Package</a></li>
<li class="toctree-l2"><a class="reference internal" href="setup.html#initialize-express-stormpath">Initialize Express-Stormpath</a></li>
<li class="toctree-l2"><a class="reference internal" href="setup.html#example-applications">Example Applications</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="configuration.html">Configuration</a><ul>
<li class="toctree-l2"><a class="reference internal" href="configuration.html#environment-variables">Environment Variables</a></li>
<li class="toctree-l2"><a class="reference internal" href="configuration.html#inline-options">Inline Options</a></li>
<li class="toctree-l2"><a class="reference internal" href="configuration.html#default-features">Default Features</a></li>
<li class="toctree-l2"><a class="reference internal" href="configuration.html#disabling-features">Disabling Features</a></li>
<li class="toctree-l2"><a class="reference internal" href="configuration.html#stormpath-client-options">Stormpath Client Options</a></li>
<li class="toctree-l2"><a class="reference internal" href="configuration.html#stormpath-application">Stormpath Application</a></li>
<li class="toctree-l2"><a class="reference internal" href="configuration.html#single-page-applications">Single Page Applications</a></li>
<li class="toctree-l2"><a class="reference internal" href="configuration.html#logging">Logging</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="user_data.html">User Data</a><ul>
<li class="toctree-l2"><a class="reference internal" href="user_data.html#req-user">req.user</a><ul>
<li class="toctree-l3"><a class="reference internal" href="user_data.html#resolving-the-current-user">Resolving The Current User</a></li>
<li class="toctree-l3"><a class="reference internal" href="user_data.html#forcing-authentication">Forcing Authentication</a></li>
<li class="toctree-l3"><a class="reference internal" href="user_data.html#modifying-the-user">Modifying The User</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="user_data.html#custom-data">Custom Data</a></li>
<li class="toctree-l2"><a class="reference internal" href="user_data.html#automatic-expansion">Automatic Expansion</a></li>
<li class="toctree-l2"><a class="reference internal" href="user_data.html#collections">Collections</a></li>
<li class="toctree-l2"><a class="reference internal" href="user_data.html#current-user-json-api">Current User JSON API</a></li>
</ul>
</li>
<li class="toctree-l1 current"><a class="current reference internal" href="#">Authentication</a><ul>
<li class="toctree-l2"><a class="reference internal" href="#password-authentication">Password Authentication</a><ul>
<li class="toctree-l3"><a class="reference internal" href="#client-api">Client API</a></li>
<li class="toctree-l3"><a class="reference internal" href="#html-login-form">HTML Login Form</a></li>
<li class="toctree-l3"><a class="reference internal" href="#json-login-api">JSON Login API</a></li>
<li class="toctree-l3"><a class="reference internal" href="#local-oauth2-api">Local OAuth2 API</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="#token-authentication">Token Authentication</a><ul>
<li class="toctree-l3"><a class="reference internal" href="#authorization-header">Authorization Header</a></li>
<li class="toctree-l3"><a class="reference internal" href="#cookies">Cookies</a></li>
<li class="toctree-l3"><a class="reference internal" href="#requiring-authentication">Requiring Authentication</a></li>
<li class="toctree-l3"><a class="reference internal" href="#refreshing-tokens">Refreshing Tokens</a></li>
<li class="toctree-l3"><a class="reference internal" href="#validation-strategy">Validation Strategy</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="#api-key-authentication">API Key Authentication</a><ul>
<li class="toctree-l3"><a class="reference internal" href="#creating-api-keys">Creating API Keys</a></li>
<li class="toctree-l3"><a class="reference internal" href="#http-basic-authentication">HTTP Basic Authentication</a></li>
<li class="toctree-l3"><a class="reference internal" href="#oauth2-client-credentials">OAuth2 Client Credentials</a></li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="authorization.html">Authorization</a><ul>
<li class="toctree-l2"><a class="reference internal" href="authorization.html#group-based-access-control">Group-based Access Control</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="registration.html">Registration</a><ul>
<li class="toctree-l2"><a class="reference internal" href="registration.html#configuration-options">Configuration Options</a></li>
<li class="toctree-l2"><a class="reference internal" href="registration.html#modifying-default-fields">Modifying Default Fields</a><ul>
<li class="toctree-l3"><a class="reference internal" href="registration.html#configure-first-name-and-last-name-as-optional">Configure First Name and Last Name as Optional</a></li>
<li class="toctree-l3"><a class="reference internal" href="registration.html#disabling-first-name-and-last-name">Disabling First Name and Last Name</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="registration.html#creating-custom-fields">Creating Custom Fields</a></li>
<li class="toctree-l2"><a class="reference internal" href="registration.html#changing-field-order">Changing Field Order</a></li>
<li class="toctree-l2"><a class="reference internal" href="registration.html#password-strength-rules">Password Strength Rules</a></li>
<li class="toctree-l2"><a class="reference internal" href="registration.html#email-verification">Email Verification</a></li>
<li class="toctree-l2"><a class="reference internal" href="registration.html#auto-login">Auto Login</a></li>
<li class="toctree-l2"><a class="reference internal" href="registration.html#pre-registration-handler">Pre Registration Handler</a></li>
<li class="toctree-l2"><a class="reference internal" href="registration.html#post-registration-handler">Post Registration Handler</a></li>
<li class="toctree-l2"><a class="reference internal" href="registration.html#json-registration-api">JSON Registration API</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="login.html">Login</a><ul>
<li class="toctree-l2"><a class="reference internal" href="login.html#next-uri">Next URI</a></li>
<li class="toctree-l2"><a class="reference internal" href="login.html#form-customization">Form Customization</a></li>
<li class="toctree-l2"><a class="reference internal" href="login.html#json-login-api">JSON Login API</a></li>
<li class="toctree-l2"><a class="reference internal" href="login.html#pre-login-handler">Pre Login Handler</a></li>
<li class="toctree-l2"><a class="reference internal" href="login.html#post-login-handler">Post Login Handler</a></li>
<li class="toctree-l2"><a class="reference internal" href="login.html#using-id-site">Using ID Site</a><ul>
<li class="toctree-l3"><a class="reference internal" href="login.html#id-site-configuration">ID Site Configuration</a></li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="social_login.html">Social Login</a><ul>
<li class="toctree-l2"><a class="reference internal" href="social_login.html#facebook-login">Facebook Login</a><ul>
<li class="toctree-l3"><a class="reference internal" href="social_login.html#create-a-facebook-app">Create a Facebook App</a></li>
<li class="toctree-l3"><a class="reference internal" href="social_login.html#specify-allowed-urls">Specify Allowed URLs</a></li>
<li class="toctree-l3"><a class="reference internal" href="social_login.html#create-a-facebook-directory">Create a Facebook Directory</a></li>
<li class="toctree-l3"><a class="reference internal" href="social_login.html#test-it-out">Test it Out</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="social_login.html#google-login">Google Login</a><ul>
<li class="toctree-l3"><a class="reference internal" href="social_login.html#create-a-google-project">Create a Google Project</a></li>
<li class="toctree-l3"><a class="reference internal" href="social_login.html#enable-google-login">Enable Google Login</a></li>
<li class="toctree-l3"><a class="reference internal" href="social_login.html#create-oauth-credentials">Create OAuth Credentials</a></li>
<li class="toctree-l3"><a class="reference internal" href="social_login.html#create-a-google-directory">Create a Google Directory</a></li>
<li class="toctree-l3"><a class="reference internal" href="social_login.html#id1">Test it Out</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="social_login.html#linkedin-login">LinkedIn Login</a><ul>
<li class="toctree-l3"><a class="reference internal" href="social_login.html#create-a-linkedin-application">Create a LinkedIn Application</a></li>
<li class="toctree-l3"><a class="reference internal" href="social_login.html#enable-linkedin-permissions">Enable LinkedIn Permissions</a></li>
<li class="toctree-l3"><a class="reference internal" href="social_login.html#create-a-linkedin-directory">Create a LinkedIn Directory</a></li>
<li class="toctree-l3"><a class="reference internal" href="social_login.html#id2">Test it Out</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="social_login.html#json-api">JSON API</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="logout.html">Logout</a><ul>
<li class="toctree-l2"><a class="reference internal" href="logout.html#configuration-options">Configuration Options</a></li>
<li class="toctree-l2"><a class="reference internal" href="logout.html#post-logout-handler">Post Logout Handler</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="password_reset.html">Password Reset</a><ul>
<li class="toctree-l2"><a class="reference internal" href="password_reset.html#enable-the-workflow">Enable the Workflow</a></li>
<li class="toctree-l2"><a class="reference internal" href="password_reset.html#using-the-workflow">Using the Workflow</a></li>
<li class="toctree-l2"><a class="reference internal" href="password_reset.html#auto-login">Auto Login</a></li>
<li class="toctree-l2"><a class="reference internal" href="password_reset.html#customizing-the-ux">Customizing the UX</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="multi_tenancy.html">Multi Tenancy</a><ul>
<li class="toctree-l2"><a class="reference internal" href="multi_tenancy.html#enabling-subdomain-based-multi-tenancy">Enabling Subdomain-based Multi-Tenancy</a></li>
<li class="toctree-l2"><a class="reference internal" href="multi_tenancy.html#example-subdomain-scenario">Example Subdomain Scenario</a></li>
<li class="toctree-l2"><a class="reference internal" href="multi_tenancy.html#authenticated-organization-context">Authenticated Organization Context</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="templates.html">Templates</a><ul>
<li class="toctree-l2"><a class="reference internal" href="templates.html#default-views">Default Views</a></li>
<li class="toctree-l2"><a class="reference internal" href="templates.html#custom-views">Custom Views</a></li>
<li class="toctree-l2"><a class="reference internal" href="templates.html#view-variables">View Variables</a></li>
<li class="toctree-l2"><a class="reference internal" href="templates.html#request-variables">Request Variables</a></li>
<li class="toctree-l2"><a class="reference internal" href="templates.html#response-variables">Response Variables</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="help.html">Getting Help</a></li>
<li class="toctree-l1"><a class="reference internal" href="contributors.html">Contributors</a><ul>
<li class="toctree-l2"><a class="reference internal" href="contributors.html#developers">Developers</a><ul>
<li class="toctree-l3"><a class="reference internal" href="contributors.html#marc-antoine-lemieux">Marc-Antoine Lemieux</a></li>
<li class="toctree-l3"><a class="reference internal" href="contributors.html#jeff-kolesky">Jeff Kolesky</a></li>
<li class="toctree-l3"><a class="reference internal" href="contributors.html#elodie-mercure">Elodie Mercure</a></li>
<li class="toctree-l3"><a class="reference internal" href="contributors.html#jmls">jmls</a></li>
<li class="toctree-l3"><a class="reference internal" href="contributors.html#cannibal-vox">Cannibal Vox</a></li>
<li class="toctree-l3"><a class="reference internal" href="contributors.html#luke-hertert">Luke Hertert</a></li>
<li class="toctree-l3"><a class="reference internal" href="contributors.html#indra-setiawan">Indra Setiawan</a></li>
<li class="toctree-l3"><a class="reference internal" href="contributors.html#david-gisser">David Gisser</a></li>
<li class="toctree-l3"><a class="reference internal" href="contributors.html#chris-daniel">Chris Daniel</a></li>
<li class="toctree-l3"><a class="reference internal" href="contributors.html#jrodmanu">JrodManU</a></li>
<li class="toctree-l3"><a class="reference internal" href="contributors.html#pierre-david-belanger">Pierre-David Bélanger</a></li>
<li class="toctree-l3"><a class="reference internal" href="contributors.html#joe-wilson">Joe Wilson</a></li>
<li class="toctree-l3"><a class="reference internal" href="contributors.html#stevebread">stevebread</a></li>
<li class="toctree-l3"><a class="reference internal" href="contributors.html#benjamin-caldwell">Benjamin Caldwell</a></li>
<li class="toctree-l3"><a class="reference internal" href="contributors.html#martin-booth">Martin Booth</a></li>
<li class="toctree-l3"><a class="reference internal" href="contributors.html#harai-akihiro">Harai Akihiro</a></li>
</ul>
</li>
</ul>
</li>
</ul>
<ul>
<li class="toctree-l1"><a class="reference internal" href="changelog.html">Change Log</a><ul>
<li class="toctree-l2"><a class="reference internal" href="changelog.html#version-4-0-0">Version 4.0.0</a></li>
<li class="toctree-l2"><a class="reference internal" href="changelog.html#version-4-0-0-rc4">Version 4.0.0-rc4</a></li>
<li class="toctree-l2"><a class="reference internal" href="changelog.html#version-4-0-0-rc3">Version 4.0.0-rc3</a></li>
<li class="toctree-l2"><a class="reference internal" href="changelog.html#version-4-0-0-rc2">Version 4.0.0-rc2</a></li>
<li class="toctree-l2"><a class="reference internal" href="changelog.html#version-4-0-0-rc1">Version 4.0.0-rc1</a></li>
<li class="toctree-l2"><a class="reference internal" href="changelog.html#version-3-2-0">Version 3.2.0</a></li>
<li class="toctree-l2"><a class="reference internal" href="changelog.html#version-3-1-9">Version 3.1.9</a></li>
<li class="toctree-l2"><a class="reference internal" href="changelog.html#version-3-1-8">Version 3.1.8</a></li>
<li class="toctree-l2"><a class="reference internal" href="changelog.html#version-3-1-7">Version 3.1.7</a></li>
<li class="toctree-l2"><a class="reference internal" href="changelog.html#version-3-1-6">Version 3.1.6</a></li>
<li class="toctree-l2"><a class="reference internal" href="changelog.html#version-3-1-5">Version 3.1.5</a></li>
<li class="toctree-l2"><a class="reference internal" href="changelog.html#version-3-1-4">Version 3.1.4</a></li>
<li class="toctree-l2"><a class="reference internal" href="changelog.html#version-3-1-3">Version 3.1.3</a></li>
<li class="toctree-l2"><a class="reference internal" href="changelog.html#version-3-1-2">Version 3.1.2</a></li>
<li class="toctree-l2"><a class="reference internal" href="changelog.html#version-3-1-1">Version 3.1.1</a></li>
<li class="toctree-l2"><a class="reference internal" href="changelog.html#version-3-1-0">Version 3.1.0</a></li>
<li class="toctree-l2"><a class="reference internal" href="changelog.html#version-3-0-1">Version 3.0.1</a></li>
<li class="toctree-l2"><a class="reference internal" href="changelog.html#major-release-3-0-0">Major Release 3.0.0</a><ul>
<li class="toctree-l3"><a class="reference internal" href="changelog.html#configuration-changes">Configuration Changes</a></li>
<li class="toctree-l3"><a class="reference internal" href="changelog.html#performance-changes">Performance Changes</a></li>
<li class="toctree-l3"><a class="reference internal" href="changelog.html#new-features">New Features</a></li>
<li class="toctree-l3"><a class="reference internal" href="changelog.html#bug-fixes">Bug Fixes</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="changelog.html#version-2-4-0">Version 2.4.0</a></li>
<li class="toctree-l2"><a class="reference internal" href="changelog.html#version-2-3-7">Version 2.3.7</a></li>
<li class="toctree-l2"><a class="reference internal" href="changelog.html#version-2-3-6">Version 2.3.6</a></li>
<li class="toctree-l2"><a class="reference internal" href="changelog.html#version-2-3-5">Version 2.3.5</a></li>
<li class="toctree-l2"><a class="reference internal" href="changelog.html#version-2-3-4">Version 2.3.4</a></li>
<li class="toctree-l2"><a class="reference internal" href="changelog.html#version-2-3-3">Version 2.3.3</a></li>
<li class="toctree-l2"><a class="reference internal" href="changelog.html#version-2-3-2">Version 2.3.2</a></li>
<li class="toctree-l2"><a class="reference internal" href="changelog.html#version-2-3-1">Version 2.3.1</a></li>
<li class="toctree-l2"><a class="reference internal" href="changelog.html#version-2-3-0">Version 2.3.0</a></li>
<li class="toctree-l2"><a class="reference internal" href="changelog.html#version-2-2-0">Version 2.2.0</a></li>
<li class="toctree-l2"><a class="reference internal" href="changelog.html#version-2-1-0">Version 2.1.0</a></li>
<li class="toctree-l2"><a class="reference internal" href="changelog.html#version-2-0-14">Version 2.0.14</a></li>
<li class="toctree-l2"><a class="reference internal" href="changelog.html#version-2-0-13">Version 2.0.13</a></li>
<li class="toctree-l2"><a class="reference internal" href="changelog.html#version-2-0-12">Version 2.0.12</a></li>
<li class="toctree-l2"><a class="reference internal" href="changelog.html#version-2-0-11">Version 2.0.11</a></li>
<li class="toctree-l2"><a class="reference internal" href="changelog.html#version-2-0-10">Version 2.0.10</a></li>
<li class="toctree-l2"><a class="reference internal" href="changelog.html#version-2-0-9">Version 2.0.9</a></li>
<li class="toctree-l2"><a class="reference internal" href="changelog.html#version-2-0-8">Version 2.0.8</a></li>
<li class="toctree-l2"><a class="reference internal" href="changelog.html#version-2-0-7">Version 2.0.7</a></li>
<li class="toctree-l2"><a class="reference internal" href="changelog.html#version-2-0-6">Version 2.0.6</a></li>
<li class="toctree-l2"><a class="reference internal" href="changelog.html#version-2-0-5">Version 2.0.5</a></li>
<li class="toctree-l2"><a class="reference internal" href="changelog.html#version-2-0-4">Version 2.0.4</a></li>
<li class="toctree-l2"><a class="reference internal" href="changelog.html#version-2-0-3">Version 2.0.3</a></li>
<li class="toctree-l2"><a class="reference internal" href="changelog.html#version-2-0-2">Version 2.0.2</a></li>
<li class="toctree-l2"><a class="reference internal" href="changelog.html#version-2-0-1">Version 2.0.1</a></li>
<li class="toctree-l2"><a class="reference internal" href="changelog.html#version-2-0-0">Version 2.0.0</a></li>
<li class="toctree-l2"><a class="reference internal" href="changelog.html#version-1-0-6">Version 1.0.6</a></li>
<li class="toctree-l2"><a class="reference internal" href="changelog.html#version-1-0-5">Version 1.0.5</a></li>
<li class="toctree-l2"><a class="reference internal" href="changelog.html#version-1-0-4">Version 1.0.4</a></li>
<li class="toctree-l2"><a class="reference internal" href="changelog.html#version-1-0-3">Version 1.0.3</a></li>
<li class="toctree-l2"><a class="reference internal" href="changelog.html#version-1-0-2">Version 1.0.2</a></li>
<li class="toctree-l2"><a class="reference internal" href="changelog.html#version-1-0-1">Version 1.0.1</a></li>
<li class="toctree-l2"><a class="reference internal" href="changelog.html#version-1-0-0">Version 1.0.0</a></li>
<li class="toctree-l2"><a class="reference internal" href="changelog.html#version-0-6-9">Version 0.6.9</a></li>
<li class="toctree-l2"><a class="reference internal" href="changelog.html#version-0-6-8">Version 0.6.8</a></li>
<li class="toctree-l2"><a class="reference internal" href="changelog.html#version-0-6-7">Version 0.6.7</a></li>
<li class="toctree-l2"><a class="reference internal" href="changelog.html#version-0-6-6">Version 0.6.6</a></li>
<li class="toctree-l2"><a class="reference internal" href="changelog.html#version-0-6-5">Version 0.6.5</a></li>
<li class="toctree-l2"><a class="reference internal" href="changelog.html#version-0-6-4">Version 0.6.4</a></li>
<li class="toctree-l2"><a class="reference internal" href="changelog.html#version-0-6-3">Version 0.6.3</a></li>
<li class="toctree-l2"><a class="reference internal" href="changelog.html#version-0-6-2">Version 0.6.2</a></li>
<li class="toctree-l2"><a class="reference internal" href="changelog.html#version-0-6-1">Version 0.6.1</a></li>
<li class="toctree-l2"><a class="reference internal" href="changelog.html#version-0-6-0">Version 0.6.0</a></li>
<li class="toctree-l2"><a class="reference internal" href="changelog.html#version-0-5-9">Version 0.5.9</a></li>
<li class="toctree-l2"><a class="reference internal" href="changelog.html#version-0-5-8">Version 0.5.8</a></li>
<li class="toctree-l2"><a class="reference internal" href="changelog.html#version-0-5-7">Version 0.5.7</a></li>
<li class="toctree-l2"><a class="reference internal" href="changelog.html#version-0-5-6">Version 0.5.6</a></li>
<li class="toctree-l2"><a class="reference internal" href="changelog.html#version-0-5-5">Version 0.5.5</a></li>
<li class="toctree-l2"><a class="reference internal" href="changelog.html#version-0-5-4">Version 0.5.4</a></li>
<li class="toctree-l2"><a class="reference internal" href="changelog.html#version-0-5-3">Version 0.5.3</a></li>
<li class="toctree-l2"><a class="reference internal" href="changelog.html#version-0-5-2">Version 0.5.2</a></li>
<li class="toctree-l2"><a class="reference internal" href="changelog.html#version-0-5-1">Version 0.5.1</a></li>
<li class="toctree-l2"><a class="reference internal" href="changelog.html#version-0-5-0">Version 0.5.0</a></li>
<li class="toctree-l2"><a class="reference internal" href="changelog.html#version-0-4-9">Version 0.4.9</a></li>
<li class="toctree-l2"><a class="reference internal" href="changelog.html#version-0-4-8">Version 0.4.8</a></li>
<li class="toctree-l2"><a class="reference internal" href="changelog.html#version-0-4-7">Version 0.4.7</a></li>
<li class="toctree-l2"><a class="reference internal" href="changelog.html#version-0-4-6">Version 0.4.6</a></li>
<li class="toctree-l2"><a class="reference internal" href="changelog.html#version-0-4-5">Version 0.4.5</a></li>
<li class="toctree-l2"><a class="reference internal" href="changelog.html#version-0-4-4">Version 0.4.4</a></li>
<li class="toctree-l2"><a class="reference internal" href="changelog.html#version-0-4-3">Version 0.4.3</a></li>
<li class="toctree-l2"><a class="reference internal" href="changelog.html#version-0-4-2">Version 0.4.2</a></li>
<li class="toctree-l2"><a class="reference internal" href="changelog.html#version-0-4-1">Version 0.4.1</a></li>
<li class="toctree-l2"><a class="reference internal" href="changelog.html#version-0-4-0">Version 0.4.0</a></li>
<li class="toctree-l2"><a class="reference internal" href="changelog.html#version-0-3-4">Version 0.3.4</a></li>
<li class="toctree-l2"><a class="reference internal" href="changelog.html#version-0-3-3">Version 0.3.3</a></li>
<li class="toctree-l2"><a class="reference internal" href="changelog.html#version-0-3-2">Version 0.3.2</a></li>
<li class="toctree-l2"><a class="reference internal" href="changelog.html#version-0-3-1">Version 0.3.1</a></li>
<li class="toctree-l2"><a class="reference internal" href="changelog.html#version-0-3-0">Version 0.3.0</a></li>
<li class="toctree-l2"><a class="reference internal" href="changelog.html#version-0-2-9">Version 0.2.9</a></li>
<li class="toctree-l2"><a class="reference internal" href="changelog.html#version-0-2-8">Version 0.2.8</a></li>
<li class="toctree-l2"><a class="reference internal" href="changelog.html#version-0-2-7">Version 0.2.7</a></li>
<li class="toctree-l2"><a class="reference internal" href="changelog.html#version-0-2-6">Version 0.2.6</a></li>
<li class="toctree-l2"><a class="reference internal" href="changelog.html#version-0-2-5">Version 0.2.5</a></li>
<li class="toctree-l2"><a class="reference internal" href="changelog.html#version-0-2-4">Version 0.2.4</a></li>
<li class="toctree-l2"><a class="reference internal" href="changelog.html#version-0-2-3">Version 0.2.3</a></li>
<li class="toctree-l2"><a class="reference internal" href="changelog.html#version-0-2-2">Version 0.2.2</a></li>
<li class="toctree-l2"><a class="reference internal" href="changelog.html#version-0-2-1">Version 0.2.1</a></li>
<li class="toctree-l2"><a class="reference internal" href="changelog.html#version-0-2-0">Version 0.2.0</a></li>
<li class="toctree-l2"><a class="reference internal" href="changelog.html#version-0-1-9">Version 0.1.9</a></li>
<li class="toctree-l2"><a class="reference internal" href="changelog.html#version-0-1-8">Version 0.1.8</a></li>
<li class="toctree-l2"><a class="reference internal" href="changelog.html#version-0-1-7">Version 0.1.7</a></li>
<li class="toctree-l2"><a class="reference internal" href="changelog.html#version-0-1-6">Version 0.1.6</a></li>
<li class="toctree-l2"><a class="reference internal" href="changelog.html#version-0-1-5">Version 0.1.5</a></li>
<li class="toctree-l2"><a class="reference internal" href="changelog.html#version-0-1-4">Version 0.1.4</a></li>
<li class="toctree-l2"><a class="reference internal" href="changelog.html#version-0-1-3">Version 0.1.3</a></li>
<li class="toctree-l2"><a class="reference internal" href="changelog.html#version-0-1-2">Version 0.1.2</a></li>
<li class="toctree-l2"><a class="reference internal" href="changelog.html#version-0-1-0">Version 0.1.0</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="upgrading.html">Upgrade Guide</a><ul>
<li class="toctree-l2"><a class="reference internal" href="upgrading.html#version-3-1-9-version-3-2-0">Version 3.1.9 -&gt; Version 3.2.0</a></li>
<li class="toctree-l2"><a class="reference internal" href="upgrading.html#version-3-1-8-version-3-1-9">Version 3.1.8 -&gt; Version 3.1.9</a></li>
<li class="toctree-l2"><a class="reference internal" href="upgrading.html#version-3-1-7-version-3-1-8">Version 3.1.7 -&gt; Version 3.1.8</a></li>
<li class="toctree-l2"><a class="reference internal" href="upgrading.html#version-3-1-6-version-3-1-7">Version 3.1.6 -&gt; Version 3.1.7</a></li>
<li class="toctree-l2"><a class="reference internal" href="upgrading.html#version-3-1-5-version-3-1-6">Version 3.1.5 -&gt; Version 3.1.6</a></li>
<li class="toctree-l2"><a class="reference internal" href="upgrading.html#version-3-1-4-version-3-1-5">Version 3.1.4 -&gt; Version 3.1.5</a></li>
<li class="toctree-l2"><a class="reference internal" href="upgrading.html#version-3-1-3-version-3-1-4">Version 3.1.3 -&gt; Version 3.1.4</a></li>
<li class="toctree-l2"><a class="reference internal" href="upgrading.html#version-3-1-2-version-3-1-3">Version 3.1.2 -&gt; Version 3.1.3</a></li>
<li class="toctree-l2"><a class="reference internal" href="upgrading.html#version-3-1-1-version-3-1-2">Version 3.1.1 -&gt; Version 3.1.2</a></li>
<li class="toctree-l2"><a class="reference internal" href="upgrading.html#version-3-1-0-version-3-1-1">Version 3.1.0 -&gt; Version 3.1.1</a></li>
<li class="toctree-l2"><a class="reference internal" href="upgrading.html#version-3-0-1-version-3-1-0">Version 3.0.1 -&gt; Version 3.1.0</a></li>
<li class="toctree-l2"><a class="reference internal" href="upgrading.html#version-3-0-0-version-3-0-1">Version 3.0.0 -&gt; Version 3.0.1</a></li>
<li class="toctree-l2"><a class="reference internal" href="upgrading.html#version-2-4-0-version-3-0-0">Version 2.4.0 -&gt; Version 3.0.0</a></li>
<li class="toctree-l2"><a class="reference internal" href="upgrading.html#version-2-3-7-version-2-4-0">Version 2.3.7 -&gt; Version 2.4.0</a></li>
<li class="toctree-l2"><a class="reference internal" href="upgrading.html#version-2-3-6-version-2-3-7">Version 2.3.6 -&gt; Version 2.3.7</a></li>
<li class="toctree-l2"><a class="reference internal" href="upgrading.html#version-2-3-5-version-2-3-6">Version 2.3.5 -&gt; Version 2.3.6</a></li>
<li class="toctree-l2"><a class="reference internal" href="upgrading.html#version-2-3-4-version-2-3-5">Version 2.3.4 -&gt; Version 2.3.5</a></li>
<li class="toctree-l2"><a class="reference internal" href="upgrading.html#version-2-3-3-version-2-3-4">Version 2.3.3 -&gt; Version 2.3.4</a></li>
<li class="toctree-l2"><a class="reference internal" href="upgrading.html#version-2-3-2-version-2-3-3">Version 2.3.2 -&gt; Version 2.3.3</a></li>
<li class="toctree-l2"><a class="reference internal" href="upgrading.html#version-2-3-1-version-2-3-2">Version 2.3.1 -&gt; Version 2.3.2</a></li>
<li class="toctree-l2"><a class="reference internal" href="upgrading.html#version-2-3-0-version-2-3-1">Version 2.3.0 -&gt; Version 2.3.1</a></li>
<li class="toctree-l2"><a class="reference internal" href="upgrading.html#version-2-2-0-version-2-3-0">Version 2.2.0 -&gt; Version 2.3.0</a></li>
<li class="toctree-l2"><a class="reference internal" href="upgrading.html#version-2-1-0-version-2-2-0">Version 2.1.0 -&gt; Version 2.2.0</a></li>
<li class="toctree-l2"><a class="reference internal" href="upgrading.html#version-2-0-14-version-2-1-0">Version 2.0.14 -&gt; Version 2.1.0</a></li>
<li class="toctree-l2"><a class="reference internal" href="upgrading.html#version-2-0-13-version-2-0-14">Version 2.0.13 -&gt; Version 2.0.14</a></li>
<li class="toctree-l2"><a class="reference internal" href="upgrading.html#version-2-0-12-version-2-0-13">Version 2.0.12 -&gt; Version 2.0.13</a></li>
<li class="toctree-l2"><a class="reference internal" href="upgrading.html#version-2-0-9-version-2-0-10">Version 2.0.9 -&gt; Version 2.0.10</a></li>
<li class="toctree-l2"><a class="reference internal" href="upgrading.html#version-2-0-8-version-2-0-9">Version 2.0.8 -&gt; Version 2.0.9</a></li>
<li class="toctree-l2"><a class="reference internal" href="upgrading.html#version-2-0-7-version-2-0-8">Version 2.0.7 -&gt; Version 2.0.8</a></li>
<li class="toctree-l2"><a class="reference internal" href="upgrading.html#version-2-0-6-version-2-0-7">Version 2.0.6 -&gt; Version 2.0.7</a></li>
<li class="toctree-l2"><a class="reference internal" href="upgrading.html#version-2-0-5-version-2-0-6">Version 2.0.5 -&gt; Version 2.0.6</a></li>
<li class="toctree-l2"><a class="reference internal" href="upgrading.html#version-2-0-4-version-2-0-5">Version 2.0.4 -&gt; Version 2.0.5</a></li>
<li class="toctree-l2"><a class="reference internal" href="upgrading.html#version-2-0-3-version-2-0-4">Version 2.0.3 -&gt; Version 2.0.4</a></li>
<li class="toctree-l2"><a class="reference internal" href="upgrading.html#version-2-0-2-version-2-0-3">Version 2.0.2 -&gt; Version 2.0.3</a></li>
<li class="toctree-l2"><a class="reference internal" href="upgrading.html#version-2-0-1-version-2-0-2">Version 2.0.1 -&gt; Version 2.0.2</a></li>
<li class="toctree-l2"><a class="reference internal" href="upgrading.html#version-2-0-0-version-2-0-1">Version 2.0.0 -&gt; Version 2.0.1</a></li>
<li class="toctree-l2"><a class="reference internal" href="upgrading.html#version-1-0-6-version-2-0-0">Version 1.0.6 -&gt; Version 2.0.0</a></li>
<li class="toctree-l2"><a class="reference internal" href="upgrading.html#version-1-0-5-version-1-0-6">Version 1.0.5 -&gt; Version 1.0.6</a></li>
<li class="toctree-l2"><a class="reference internal" href="upgrading.html#version-1-0-4-version-1-0-5">Version 1.0.4 -&gt; Version 1.0.5</a></li>
<li class="toctree-l2"><a class="reference internal" href="upgrading.html#version-1-0-3-version-1-0-4">Version 1.0.3 -&gt; Version 1.0.4</a></li>
<li class="toctree-l2"><a class="reference internal" href="upgrading.html#version-1-0-2-version-1-0-3">Version 1.0.2 -&gt; Version 1.0.3</a></li>
<li class="toctree-l2"><a class="reference internal" href="upgrading.html#version-1-0-1-version-1-0-2">Version 1.0.1 -&gt; Version 1.0.2</a></li>
<li class="toctree-l2"><a class="reference internal" href="upgrading.html#version-1-0-0-version-1-0-1">Version 1.0.0 -&gt; Version 1.0.1</a></li>
<li class="toctree-l2"><a class="reference internal" href="upgrading.html#version-0-6-9-version-1-0-0">Version 0.6.9 -&gt; Version 1.0.0</a></li>
<li class="toctree-l2"><a class="reference internal" href="upgrading.html#version-0-6-8-version-0-6-9">Version 0.6.8 -&gt; Version 0.6.9</a></li>
<li class="toctree-l2"><a class="reference internal" href="upgrading.html#version-0-6-7-version-0-6-8">Version 0.6.7 -&gt; Version 0.6.8</a></li>
<li class="toctree-l2"><a class="reference internal" href="upgrading.html#version-0-6-6-version-0-6-7">Version 0.6.6 -&gt; Version 0.6.7</a></li>
<li class="toctree-l2"><a class="reference internal" href="upgrading.html#version-0-6-5-version-0-6-6">Version 0.6.5 -&gt; Version 0.6.6</a></li>
<li class="toctree-l2"><a class="reference internal" href="upgrading.html#version-0-6-4-version-0-6-5">Version 0.6.4 -&gt; Version 0.6.5</a></li>
<li class="toctree-l2"><a class="reference internal" href="upgrading.html#version-0-6-3-version-0-6-4">Version 0.6.3 -&gt; Version 0.6.4</a></li>
<li class="toctree-l2"><a class="reference internal" href="upgrading.html#version-0-6-2-version-0-6-3">Version 0.6.2 -&gt; Version 0.6.3</a></li>
<li class="toctree-l2"><a class="reference internal" href="upgrading.html#version-0-6-1-version-0-6-2">Version 0.6.1 -&gt; Version 0.6.2</a></li>
<li class="toctree-l2"><a class="reference internal" href="upgrading.html#version-0-6-0-version-0-6-1">Version 0.6.0 -&gt; Version 0.6.1</a></li>
<li class="toctree-l2"><a class="reference internal" href="upgrading.html#version-0-5-9-version-0-6-0">Version 0.5.9 -&gt; Version 0.6.0</a></li>
<li class="toctree-l2"><a class="reference internal" href="upgrading.html#version-0-5-8-version-0-5-9">Version 0.5.8 -&gt; Version 0.5.9</a></li>
<li class="toctree-l2"><a class="reference internal" href="upgrading.html#version-0-5-7-version-0-5-8">Version 0.5.7 -&gt; Version 0.5.8</a></li>
<li class="toctree-l2"><a class="reference internal" href="upgrading.html#version-0-5-6-version-0-5-7">Version 0.5.6 -&gt; Version 0.5.7</a></li>
<li class="toctree-l2"><a class="reference internal" href="upgrading.html#version-0-5-5-version-0-5-6">Version 0.5.5 -&gt; Version 0.5.6</a></li>
<li class="toctree-l2"><a class="reference internal" href="upgrading.html#version-0-5-4-version-0-5-5">Version 0.5.4 -&gt; Version 0.5.5</a></li>
<li class="toctree-l2"><a class="reference internal" href="upgrading.html#version-0-5-3-version-0-5-4">Version 0.5.3 -&gt; Version 0.5.4</a></li>
<li class="toctree-l2"><a class="reference internal" href="upgrading.html#version-0-5-2-version-0-5-3">Version 0.5.2 -&gt; Version 0.5.3</a></li>
<li class="toctree-l2"><a class="reference internal" href="upgrading.html#version-0-5-1-version-0-5-2">Version 0.5.1 -&gt; Version 0.5.2</a></li>
<li class="toctree-l2"><a class="reference internal" href="upgrading.html#version-0-5-0-version-0-5-1">Version 0.5.0 -&gt; Version 0.5.1</a></li>
<li class="toctree-l2"><a class="reference internal" href="upgrading.html#version-0-4-9-version-0-5-0">Version 0.4.9 -&gt; Version 0.5.0</a></li>
<li class="toctree-l2"><a class="reference internal" href="upgrading.html#version-0-4-8-version-0-4-9">Version 0.4.8 -&gt; Version 0.4.9</a></li>
<li class="toctree-l2"><a class="reference internal" href="upgrading.html#version-0-4-7-version-0-4-8">Version 0.4.7 -&gt; Version 0.4.8</a></li>
<li class="toctree-l2"><a class="reference internal" href="upgrading.html#version-0-4-6-version-0-4-7">Version 0.4.6 -&gt; Version 0.4.7</a></li>
<li class="toctree-l2"><a class="reference internal" href="upgrading.html#version-0-4-5-version-0-4-6">Version 0.4.5 -&gt; Version 0.4.6</a></li>
<li class="toctree-l2"><a class="reference internal" href="upgrading.html#version-0-4-4-version-0-4-5">Version 0.4.4 -&gt; Version 0.4.5</a></li>
<li class="toctree-l2"><a class="reference internal" href="upgrading.html#version-0-4-3-version-0-4-4">Version 0.4.3 -&gt; Version 0.4.4</a></li>
<li class="toctree-l2"><a class="reference internal" href="upgrading.html#version-0-4-2-version-0-4-3">Version 0.4.2 -&gt; Version 0.4.3</a></li>
<li class="toctree-l2"><a class="reference internal" href="upgrading.html#version-0-4-1-version-0-4-2">Version 0.4.1 -&gt; Version 0.4.2</a></li>
<li class="toctree-l2"><a class="reference internal" href="upgrading.html#version-0-4-0-version-0-4-1">Version 0.4.0 -&gt; Version 0.4.1</a></li>
<li class="toctree-l2"><a class="reference internal" href="upgrading.html#version-0-3-4-version-0-4-0">Version 0.3.4 -&gt; Version 0.4.0</a></li>
<li class="toctree-l2"><a class="reference internal" href="upgrading.html#version-0-3-3-version-0-3-4">Version 0.3.3 -&gt; Version 0.3.4</a></li>
<li class="toctree-l2"><a class="reference internal" href="upgrading.html#version-0-3-2-version-0-3-3">Version 0.3.2 -&gt; Version 0.3.3</a></li>
<li class="toctree-l2"><a class="reference internal" href="upgrading.html#version-0-3-1-version-0-3-2">Version 0.3.1 -&gt; Version 0.3.2</a></li>
<li class="toctree-l2"><a class="reference internal" href="upgrading.html#version-0-3-0-version-0-3-1">Version 0.3.0 -&gt; Version 0.3.1</a></li>
<li class="toctree-l2"><a class="reference internal" href="upgrading.html#version-0-2-9-version-0-3-0">Version 0.2.9 -&gt; Version 0.3.0</a></li>
<li class="toctree-l2"><a class="reference internal" href="upgrading.html#version-0-2-8-version-0-2-9">Version 0.2.8 -&gt; Version 0.2.9</a></li>
<li class="toctree-l2"><a class="reference internal" href="upgrading.html#version-0-2-7-version-0-2-8">Version 0.2.7 -&gt; Version 0.2.8</a></li>
<li class="toctree-l2"><a class="reference internal" href="upgrading.html#version-0-2-6-version-0-2-7">Version 0.2.6 -&gt; Version 0.2.7</a></li>
<li class="toctree-l2"><a class="reference internal" href="upgrading.html#version-0-2-5-version-0-2-6">Version 0.2.5 -&gt; Version 0.2.6</a></li>
<li class="toctree-l2"><a class="reference internal" href="upgrading.html#version-0-2-4-version-0-2-5">Version 0.2.4 -&gt; Version 0.2.5</a></li>
<li class="toctree-l2"><a class="reference internal" href="upgrading.html#version-0-2-3-version-0-2-4">Version 0.2.3 -&gt; Version 0.2.4</a></li>
<li class="toctree-l2"><a class="reference internal" href="upgrading.html#version-0-2-2-version-0-2-3">Version 0.2.2 -&gt; Version 0.2.3</a></li>
<li class="toctree-l2"><a class="reference internal" href="upgrading.html#version-0-2-1-version-0-2-2">Version 0.2.1 -&gt; Version 0.2.2</a></li>
<li class="toctree-l2"><a class="reference internal" href="upgrading.html#version-0-2-0-version-0-2-1">Version 0.2.0 -&gt; Version 0.2.1</a></li>
<li class="toctree-l2"><a class="reference internal" href="upgrading.html#version-0-1-9-version-0-2-0">Version 0.1.9 -&gt; Version 0.2.0</a></li>
<li class="toctree-l2"><a class="reference internal" href="upgrading.html#version-0-1-8-version-0-1-9">Version 0.1.8 -&gt; Version 0.1.9</a></li>
<li class="toctree-l2"><a class="reference internal" href="upgrading.html#version-0-1-7-version-0-1-8">Version 0.1.7 -&gt; Version 0.1.8</a></li>
<li class="toctree-l2"><a class="reference internal" href="upgrading.html#version-0-1-6-version-0-1-7">Version 0.1.6 -&gt; Version 0.1.7</a></li>
<li class="toctree-l2"><a class="reference internal" href="upgrading.html#version-0-1-5-version-0-1-6">Version 0.1.5 -&gt; Version 0.1.6</a></li>
<li class="toctree-l2"><a class="reference internal" href="upgrading.html#version-0-1-4-version-0-1-5">Version 0.1.4 -&gt; Version 0.1.5</a></li>
<li class="toctree-l2"><a class="reference internal" href="upgrading.html#version-0-1-3-version-0-1-4">Version 0.1.3 -&gt; Version 0.1.4</a></li>
<li class="toctree-l2"><a class="reference internal" href="upgrading.html#version-0-1-2-version-0-1-3">Version 0.1.2 -&gt; Version 0.1.3</a></li>
<li class="toctree-l2"><a class="reference internal" href="upgrading.html#version-0-1-0-version-0-1-2">Version 0.1.0 -&gt; Version 0.1.2</a></li>
<li class="toctree-l2"><a class="reference internal" href="upgrading.html#version-0-0-0-version-0-1-0">Version 0.0.0 -&gt; Version 0.1.0</a></li>
</ul>
</li>
</ul>

            
          
        </div>
      </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap">

      
      <nav class="wy-nav-top" role="navigation" aria-label="top navigation">
        
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href="index.html">Express Library Guide</a>
        
      </nav>


      
      <div class="wy-nav-content">
        <div class="rst-content">
          

 







<div role="navigation" aria-label="breadcrumbs navigation">
  <ul class="wy-breadcrumbs">
    <li><a href="index.html">Docs</a> &raquo;</li>
      
    <li>Authentication</li>
    <li class="wy-breadcrumbs-aside">
      
          
          <a href="_sources/authentication.rst.txt" rel="nofollow"> View page source</a>
        
      
    </li>
  </ul>
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
           <div itemprop="articleBody">
            
  <div class="section" id="authentication">
<span id="id1"></span><h1>Authentication<a class="headerlink" href="#authentication" title="Permalink to this headline">¶</a></h1>
<p>When a user logs into your application, they are authenticating who they are.
Stormpath provides several strategies for authenticating users, including
simple passwords, social login, and organization-context authentication.</p>
<p>The common feature of all these flows is that an OAuth 2.0 access token and
refresh token pair is created for the user when they authenticate.  In this
section we will discuss the different ways that a user can authenticate, and how
you can use the granted tokens to authenticate requests to your server.</p>
<p id="setting-token-expiration-time">For all cases, we rely on the OAuth Policy of your Stormpath Application when
deciding how long tokens should be good for.  If you need to change these values,
please see <a class="reference external" href="https://docs.stormpath.com/console/product-guide/latest/applications.html#managing-an-application-s-oauth-policy">Managing an Application’s OAuth Policy</a>
in the Admin Console guide, or <a class="reference external" href="https://docs.stormpath.com/rest/product-guide/latest/auth_n.html#configuring-token-based-authentication">Configuring Token Based Authentication</a> in the REST Product Guide.</p>
<p>This section will discuss strategies that are applicable to any front-end or
mobile application.  While we recommend reading this section and understanding
the flows, Stormpath also provides client SDKs that wrap most of these behavior,
so that you don’t have to build it yourself.</p>
<p>Please visit <a class="reference external" href="https://docs.stormpath.com">https://docs.stormpath.com</a> for more information on these libraries.</p>
<div class="section" id="password-authentication">
<h2>Password Authentication<a class="headerlink" href="#password-authentication" title="Permalink to this headline">¶</a></h2>
<p>This is the most straightforward form of authentication that everyone is
familiar with.  Stormpath provides several ways for a user to provide their
username and password, in exchange for an access and refresh token.</p>
<p>In this sub-section, we will cover the different authentication endpoints that
Stormpath provides.</p>
<div class="section" id="client-api">
<h3>Client API<a class="headerlink" href="#client-api" title="Permalink to this headline">¶</a></h3>
<p>The <a class="reference external" href="https://docs.stormpath.com/client-api/product-guide/latest/">Stormpath Client API</a> is designed for front-end and mobile clients,
it is a hosted API for your application that allows the user to post their
credentials and receive an access token.  This API is useful when you want Stormpath
to host the authentication API for you, so that your Express server is not
responsible for authentication.</p>
<p>When using the Client API, you will use the standard OAuth 2.0 Password Grant
to obtain an access and refresh token.  Once the tokens have been obtained,
you can use them to authenticate requests with your express server, and this is
covered in the next sub-section, Token Authentication.</p>
<p>Please see the <a class="reference external" href="https://docs.stormpath.com/client-api/product-guide/latest/">Stormpath Client API Product Guide</a> for complete information
on authenticating the user and obtaining tokens.</p>
</div>
<div class="section" id="html-login-form">
<h3>HTML Login Form<a class="headerlink" href="#html-login-form" title="Permalink to this headline">¶</a></h3>
<p>If you have added the <code class="docutils literal"><span class="pre">express-stormpath</span></code> library to your server, we
automatically serve a login form at <code class="docutils literal"><span class="pre">/login</span></code>.  This is a simple form that allows
the user to submit their username and password.</p>
<p>If the user authenticates successfully, we create an access token and refresh
token (same as all other flows), but in this case we will store those tokens
for you in Http-Only cookies that are tied to the local domain of your Express
server.  This is convenient because the browser will automatically supply those
tokens on subsequent requests, you will not have to do extra work to send those
tokens to your server.</p>
<p id="configuring-cookie-flags">The feature is covered in detail in the <a class="reference internal" href="login.html#login"><span class="std std-ref">Login</span></a> section.  Depending on your
use-case, you may need to change some of the properties that we set on the cookies
that are automatically created by our <code class="docutils literal"><span class="pre">/login</span></code> endpoint, which can be done with
the following configuration:</p>
<div class="highlight-javascript"><div class="highlight"><pre><span></span><span class="nx">app</span><span class="p">.</span><span class="nx">use</span><span class="p">(</span><span class="nx">stormpath</span><span class="p">.</span><span class="nx">init</span><span class="p">({</span>
  <span class="nx">web</span><span class="o">:</span> <span class="p">{</span>
    <span class="nx">accessTokenCookie</span><span class="o">:</span> <span class="p">{</span>
      <span class="nx">domain</span><span class="o">:</span> <span class="kc">null</span><span class="p">,</span>
      <span class="nx">httpOnly</span><span class="o">:</span> <span class="kc">true</span><span class="p">,</span>
      <span class="nx">path</span><span class="o">:</span> <span class="s2">&quot;/&quot;</span><span class="p">,</span>
      <span class="nx">secure</span><span class="o">:</span> <span class="kc">null</span>
    <span class="p">},</span>
    <span class="nx">refreshTokenCookie</span><span class="o">:</span> <span class="p">{</span>
      <span class="c1">// same as the accessTokenCookie</span>
    <span class="p">}</span>
  <span class="p">}</span>
<span class="p">}));</span>
</pre></div>
</div>
<p>This table describes each setting in detail:</p>
<table border="1" class="docutils">
<colgroup>
<col width="17%" />
<col width="12%" />
<col width="71%" />
</colgroup>
<thead valign="bottom">
<tr class="row-odd"><th class="head">Cookie Flag</th>
<th class="head">Default</th>
<th class="head">Description</th>
</tr>
</thead>
<tbody valign="top">
<tr class="row-even"><td>domain</td>
<td>null</td>
<td>Set if needed, e.g. “subdomain.mydomain.com”.</td>
</tr>
<tr class="row-odd"><td>httpOnly</td>
<td>true</td>
<td>True by default, do not disable without good reason
(exposes tokens to XSS | attacks).</td>
</tr>
<tr class="row-even"><td>path</td>
<td>“/”</td>
<td>Set if needed, e.g. “/newapp”.</td>
</tr>
<tr class="row-odd"><td>secure</td>
<td>null</td>
<td>Will be <code class="docutils literal"><span class="pre">true</span></code> in HTTPS environments (as detected
by <code class="docutils literal"><span class="pre">req.protocol</span></code>), unless explicitly set to
<code class="docutils literal"><span class="pre">false</span></code> (not recommended!).</td>
</tr>
</tbody>
</table>
</div>
<div class="section" id="json-login-api">
<h3>JSON Login API<a class="headerlink" href="#json-login-api" title="Permalink to this headline">¶</a></h3>
<p>Similar to the HTML Login Form approach, you can post the same data to the
<code class="docutils literal"><span class="pre">/login</span></code> endpoint, but as JSON data instead of a form POST.  The result is the
same: an access and refresh token is created, and automatically stored for you
in cookies.</p>
<p>The feature is covered in detail in the <a class="reference internal" href="login.html#login"><span class="std std-ref">Login</span></a> section.</p>
</div>
<div class="section" id="local-oauth2-api">
<h3>Local OAuth2 API<a class="headerlink" href="#local-oauth2-api" title="Permalink to this headline">¶</a></h3>
<p>As mentioned earlier, you can use the <a class="reference external" href="https://docs.stormpath.com/client-api/product-guide/latest/">Stormpath Client API</a> directly from your
SPA or mobile client to authenticate the user and obtain access tokens, using
the password grant flow.</p>
<p>However, some developers need this OAuth2 API to exist on their server, likely
because they want it to be on the same domain as the rest of their application.
If you have added the <code class="docutils literal"><span class="pre">express-stormpath</span></code> library to your server, we
automatically serve the OAuth 2.0 API at <code class="docutils literal"><span class="pre">/oauth/token</span></code>.  This is the same API
that you can use from the <a class="reference external" href="https://docs.stormpath.com/client-api/product-guide/latest/">Stormpath Client API</a>, but in this case it is simply
served by your Express server.  The result is the same: your client will receive
tokens after a successful password authentication.</p>
<p>Just like the <a class="reference external" href="https://docs.stormpath.com/client-api/product-guide/latest/">Stormpath Client API</a>, the format of an authentication request should look like this:</p>
<div class="highlight-text"><div class="highlight"><pre><span></span>POST http://localhost:3000/oauth/token HTTP/1.1
Content-Type: application/x-www-form-urlencoded

grant_type=password&amp;username=user@gmail.com&amp;password=theirPassword
</pre></div>
</div>
<p>The response will be a standard OAuth 2.0 response, providing your client with
the necessary tokens:</p>
<div class="highlight-javascript"><div class="highlight"><pre><span></span><span class="p">{</span>
  <span class="s2">&quot;refresh_token&quot;</span><span class="o">:</span> <span class="s2">&quot;eyJraWQiOiI2...&quot;</span><span class="p">,</span>
  <span class="s2">&quot;stormpath_access_token_href&quot;</span><span class="o">:</span> <span class="s2">&quot;https://api.stormpath.com/v1/accessTokens/3bBAHmSuTJ64DM574awVen&quot;</span><span class="p">,</span>
  <span class="s2">&quot;token_type&quot;</span><span class="o">:</span> <span class="s2">&quot;Bearer&quot;</span><span class="p">,</span>
  <span class="s2">&quot;access_token&quot;</span><span class="o">:</span> <span class="s2">&quot;eyJraWQiOiI2Nl...&quot;</span><span class="p">,</span>
  <span class="s2">&quot;expires_in&quot;</span><span class="o">:</span> <span class="mi">3600</span>
<span class="p">}</span>
</pre></div>
</div>
</div>
</div>
<div class="section" id="token-authentication">
<h2>Token Authentication<a class="headerlink" href="#token-authentication" title="Permalink to this headline">¶</a></h2>
<p>So far we have discussed the various ways in which a user (and their client, e.g.
your single-page app or mobile app) can obtain an access and refresh token.
Once the client has tokens, they can use them to authenticate HTTP requests to
your server.  In this section we will show you the various ways this is possible.</p>
<div class="section" id="authorization-header">
<h3>Authorization Header<a class="headerlink" href="#authorization-header" title="Permalink to this headline">¶</a></h3>
<p>In this scenario, the client adds the <code class="docutils literal"><span class="pre">Authorization</span></code> header to the HTTP
request, and supplies the access token as the value of the header, using the
<code class="docutils literal"><span class="pre">Bearer</span> <span class="pre">&lt;access_token&gt;</span></code> scheme.  This scenario is typically used in the following
situations:</p>
<ul class="simple">
<li>Mobile applications, which prefer the <code class="docutils literal"><span class="pre">Authorization</span></code> approach over a cookie solution.  They typically do not have cookie store implementations.</li>
<li>Single Page Apps (SPAs), when the authentication API is not on the same domain as the API that requires authentication. This is true when using the <a class="reference external" href="https://docs.stormpath.com/client-api/product-guide/latest/">Stormpath Client API</a> as your authentication domain.</li>
</ul>
<p>An example header would look like this:</p>
<div class="highlight-text"><div class="highlight"><pre><span></span>Authorization: Bearer eyJraWQiOiI2NldURFJVM1paSkNZVFJVVlZTUUw3WEJOIiwic3R0IjoiYWNjZXNzIiwiYWxnIjoiSFMyNTYifQ.eyJqdGkiOiIzV0llS3N1SmR6YWR5YzN4U1ltc1l6IiwiaWF0IjoxNDY5ODMzNzQ3LCJpc3MiOiJodHRwczovL2FwaS5zdG9ybXBhdGguY29tL3YxL2FwcGxpY2F0aW9ucy8yNGs3SG5ET3o0dFE5QVJzQnRQVU42Iiwic3ViIjoiaHR0cHM6Ly9hcGkuc3Rvcm1wYXRoLmNvbS92MS9hY2NvdW50cy8yRWRHb3htbGpuODBlRHZjM0JzS05EIiwiZXhwIjoxNDY5ODM0MzQ3LCJydGkiOiIzV0llS3BhRWpQSGZMbXk2R0l2Ynd2In0.9J7HvhgJZxvxuE-0PiarTDTFPCVVLR_nvRByULNA01Q
</pre></div>
</div>
</div>
<div class="section" id="cookies">
<h3>Cookies<a class="headerlink" href="#cookies" title="Permalink to this headline">¶</a></h3>
<p>While the <code class="docutils literal"><span class="pre">Authorization</span></code> header approach is becoming more common, cookies
still offer some advantages and Stormpath supports cookies as a means for sending
the access token to your server.  Cookies are useful for these scenarios:</p>
<ul class="simple">
<li>Enhanced security for browser clients: HTTP-Only, Secure cookies (with a CSRF mitigation solution) can be more secure than using Local Storage, as the Local Storage API is vulnerable to XSS attacks.</li>
<li>Clients can be simpler, as they don’t need to manually supply the token on every request (the browser does this for you).</li>
</ul>
<p>Stormpath provides an additional feature for cookie authentication: we will
transparently refresh the access token for you, so that you client does not need
to do this.</p>
<p>If you would like to authenticate requests with cookies, the access token and
refresh token should be supplied with as the <code class="docutils literal"><span class="pre">access_token</span></code> and <code class="docutils literal"><span class="pre">refresh_token</span></code>
values when creating the <code class="docutils literal"><span class="pre">Cookie</span></code> header of the request. For example:</p>
<div class="highlight-text"><div class="highlight"><pre><span></span>Cookie: access_token=eyJraWQiOiIyMzhCSFRDQTlXUzhEMTJOUkdMMU5OMVNGIiwic3R0IjoiYWNjZXNzIiwiYWxnIjoiSFMyNTYifQ.eyJqdGkiOiI1Q1ExQldvdW5YS2NCZmpMMFltMXUwIiwiaWF0IjoxNDg1Mjk5NTg4LCJpc3MiOiJodHRwczovL2FwaS5zdG9ybXBhdGguY29tL3YxL2FwcGxpY2F0aW9ucy8yNGs3SG5ET3o0dFE5QVJzQnRQVU42Iiwic3ViIjoiaHR0cHM6Ly9hcGkuc3Rvcm1wYXRoLmNvbS92MS9hY2NvdW50cy81dThCWVp0dTA5czN5ZDFYdERZUlNvIiwiZXhwIjoxNDg2MTYzNTg4LCJydGkiOiI1Q1ExQlRVcHN4MWRZcWRUb0l1bEh3In0.epnM3D-pMMoHYdYziQJt-m1Nibmdbr_qPuJOSrfoqAw; refresh_token=eyJraWQiOiIyMzhCSFRDQTlXUzhEMTJOUkdMMU5OMVNGIiwic3R0IjoicmVmcmVzaCIsImFsZyI6IkhTMjU2In0.eyJqdGkiOiI1Q1ExQlRVcHN4MWRZcWRUb0l1bEh3IiwiaWF0IjoxNDg1Mjk5NTg4LCJpc3MiOiJodHRwczovL2FwaS5zdG9ybXBhdGguY29tL3YxL2FwcGxpY2F0aW9ucy8yNGs3SG5ET3o0dFE5QVJzQnRQVU42Iiwic3ViIjoiaHR0cHM6Ly9hcGkuc3Rvcm1wYXRoLmNvbS92MS9hY2NvdW50cy81dThCWVp0dTA5czN5ZDFYdERZUlNvIiwiZXhwIjoxNDg3MDI3NTg4fQ.4BE4LtR7zakTfkWeA86TM1fsEM8bhv2SFYcVCkBNy3Y
</pre></div>
</div>
</div>
<div class="section" id="requiring-authentication">
<h3>Requiring Authentication<a class="headerlink" href="#requiring-authentication" title="Permalink to this headline">¶</a></h3>
<p>You can protect APIs on your server by requiring authentication, using the
<code class="docutils literal"><span class="pre">authenticationRequired</span></code> middleware.  This middleware will look for an access token
in the <code class="docutils literal"><span class="pre">Authorization</span></code> or <code class="docutils literal"><span class="pre">Cookie</span></code> header of the request.  If an access token
is found, it will assert that the access token is not expired and that is was
issued by the Stormpath Application that was specified by your configuration
when initializing <code class="docutils literal"><span class="pre">express-stormpath</span></code>.</p>
<p>Here is an example of requiring authentication for a particular endpoint:</p>
<div class="highlight-javascript"><div class="highlight"><pre><span></span><span class="nx">app</span><span class="p">.</span><span class="nx">get</span><span class="p">(</span><span class="s1">&#39;/secret&#39;</span><span class="p">,</span> <span class="nx">stormpath</span><span class="p">.</span><span class="nx">authenticationRequired</span><span class="p">,</span> <span class="kd">function</span> <span class="p">(</span><span class="nx">req</span><span class="p">,</span> <span class="nx">res</span><span class="p">)</span> <span class="p">{</span>
  <span class="nx">res</span><span class="p">.</span><span class="nx">json</span><span class="p">({</span>
    <span class="nx">message</span><span class="o">:</span> <span class="s2">&quot;Hello, &quot;</span> <span class="o">+</span> <span class="nx">req</span><span class="p">.</span><span class="nx">user</span><span class="p">.</span><span class="nx">fullname</span>
  <span class="p">});</span>
<span class="p">});</span>
</pre></div>
</div>
<p>If the request failed authentication, the user will be redirected to the login page, or given an error response (depending on the <code class="docutils literal"><span class="pre">Accept</span></code> header of the request).</p>
</div>
<div class="section" id="refreshing-tokens">
<h3>Refreshing Tokens<a class="headerlink" href="#refreshing-tokens" title="Permalink to this headline">¶</a></h3>
<p>When the access token has expired, the client can use the refresh token to
obtain a new token.  If you are using one of our front-end or mobile SDKs, this
is done for you automatically.  If you need to manually get a new access token,
you make a <code class="docutils literal"><span class="pre">refresh_token</span></code> grant type POST to the <code class="docutils literal"><span class="pre">/oauth/token</span></code> endpoint of
your server, or the <a class="reference external" href="https://docs.stormpath.com/client-api/product-guide/latest/">Stormpath Client API</a>. The client request looks like this:</p>
<div class="highlight-text"><div class="highlight"><pre><span></span>POST http://localhost:3000/oauth/token HTTP/1.1
Content-Type: application/x-www-form-urlencoded

grant_type=refresh_token&amp;refresh_token=eyJraWQiOiIyMzhCSFRDQTlXUzhEMTJOUkdMMU5OMVNGIiwic3R0IjoicmVmcmVzaCIsImFsZyI6IkhTMjU2In0.eyJqdGkiOiI1Q1ExQlRVcHN4MWRZcWRUb0l1bEh3IiwiaWF0IjoxNDg1Mjk5NTg4LCJpc3MiOiJodHRwczovL2FwaS5zdG9ybXBhdGguY29tL3YxL2FwcGxpY2F0aW9ucy8yNGs3SG5ET3o0dFE5QVJzQnRQVU42Iiwic3ViIjoiaHR0cHM6Ly9hcGkuc3Rvcm1wYXRoLmNvbS92MS9hY2NvdW50cy81dThCWVp0dTA5czN5ZDFYdERZUlNvIiwiZXhwIjoxNDg3MDI3NTg4fQ.4BE4LtR7zakTfkWeA86TM1fsEM8bhv2SFYcVCkBNy3Y
</pre></div>
</div>
<p>The response will contain a new access token.  Once the refresh token expires,
the user will have to re-authenticate with a username and password to get a new token pair.</p>
<p>For full documentation on our OAuth2 Access Token features, please see
<a class="reference external" href="http://docs.stormpath.com/guides/token-management/">How Token-Based Authentication Works</a></p>
</div>
<div class="section" id="validation-strategy">
<span id="token-validation-strategy"></span><h3>Validation Strategy<a class="headerlink" href="#validation-strategy" title="Permalink to this headline">¶</a></h3>
<p>When a request comes into your server, this library will use the access token,
provided by the client, to make an authentication decision.  The default
validation strategy (<code class="docutils literal"><span class="pre">local</span></code>) works like this:</p>
<ul class="simple">
<li>If the Access Token was issued by your Stormpath Application, and the token is not expired, the request is accepted.</li>
<li>If the Access Token is expired, attempt to get a new one from the Stormpath
REST API by using the Refresh Token (if the refresh token was presented as a cookie).</li>
<li>If a new Access Token cannot be obtained, deny the request.</li>
</ul>
<p>With the <code class="docutils literal"><span class="pre">local</span></code> option, our library only checks the signature and expiration of
the Access Token.  It does not check with the Stormpath REST API to assert that
the Access Token hasn’t been revoked.</p>
<p>If you would like to check for Access Token revocation on every request, you
should opt-in to the <code class="docutils literal"><span class="pre">stormpath</span></code> validation strategy.  This will make a
network call to the Stormpath REST API.  If the Access Token has been revoked,
or the account has been disabled or deleted, the request will be rejected.</p>
<p>Opt-in to <code class="docutils literal"><span class="pre">stormpath</span></code> validation with this configuration:</p>
<div class="highlight-javascript"><div class="highlight"><pre><span></span><span class="p">{</span>
  <span class="nx">web</span><span class="o">:</span> <span class="p">{</span>
    <span class="nx">oauth2</span><span class="o">:</span> <span class="p">{</span>
      <span class="nx">password</span><span class="o">:</span> <span class="p">{</span>
        <span class="nx">validationStrategy</span><span class="o">:</span> <span class="s1">&#39;stormpath&#39;</span>
      <span class="p">}</span>
    <span class="p">}</span>
  <span class="p">}</span>
<span class="p">}</span>
</pre></div>
</div>
<div class="admonition warning">
<p class="first admonition-title">Warning</p>
<p>When using local validation, your server will not be aware of token revocation
or any changes to the associated Stormpath account.  <strong>This is a security
trade-off that optimizes for performance.</strong>  If you prefer extra security, use
the <code class="docutils literal"><span class="pre">stormpath</span></code> validation option.</p>
<p>If you prefer local validation, for the performance reasons, you can add more
security by doing one of the following:</p>
<ul class="last simple">
<li>Use a short expiration time for your Access Tokens (such as five minutes or
less).  This will limit the amount of time that the Access Token can be used
for validation, while still reducing the number of times that we need to
make a REST API call, with the refresh token, to get a new access token.</li>
<li>Maintain a blacklist of revoked Access Tokens, in your local application
cache. Implement a middleware function that asserts that the Access Token is
not in this cache, and reject the request if true.  We may implement this as
a convenience feature in the future.</li>
</ul>
</div>
</div>
</div>
<div class="section" id="api-key-authentication">
<h2>API Key Authentication<a class="headerlink" href="#api-key-authentication" title="Permalink to this headline">¶</a></h2>
<p>If you are building an API service, you will need to distribute API keys to your
developers.  They will then use these keys to authenticate with your API, either
via HTTP Basic Auth or OAuth2 Access tokens.  We’ll cover those strategies in
the next sections, but we need to provision API keys for your developers first.</p>
<div class="section" id="creating-api-keys">
<h3>Creating API Keys<a class="headerlink" href="#creating-api-keys" title="Permalink to this headline">¶</a></h3>
<p>While your service may be an API service, you will still need to provide a
basic website that developers can use to obtain their keys.  Here is an example
of how you can create an API Key for the currently logged in user:</p>
<div class="highlight-javascript"><div class="highlight"><pre><span></span><span class="nx">app</span><span class="p">.</span><span class="nx">post</span><span class="p">(</span><span class="s1">&#39;/apiKeys&#39;</span><span class="p">,</span> <span class="nx">stormpath</span><span class="p">.</span><span class="nx">authenticationRequired</span><span class="p">,</span> <span class="kd">function</span> <span class="p">(</span><span class="nx">req</span><span class="p">,</span> <span class="nx">res</span><span class="p">)</span> <span class="p">{</span>
  <span class="nx">req</span><span class="p">.</span><span class="nx">user</span><span class="p">.</span><span class="nx">createApiKey</span><span class="p">(</span><span class="kd">function</span> <span class="p">(</span><span class="nx">err</span><span class="p">,</span> <span class="nx">apiKey</span><span class="p">)</span> <span class="p">{</span>
    <span class="k">if</span> <span class="p">(</span><span class="nx">err</span><span class="p">)</span> <span class="p">{</span>
      <span class="nx">res</span><span class="p">.</span><span class="nx">status</span><span class="p">(</span><span class="mi">400</span><span class="p">).</span><span class="nx">end</span><span class="p">(</span><span class="s1">&#39;Oops!  There was an error: &#39;</span> <span class="o">+</span> <span class="nx">err</span><span class="p">.</span><span class="nx">userMessage</span><span class="p">);</span>
    <span class="p">}</span><span class="k">else</span><span class="p">{</span>
      <span class="nx">res</span><span class="p">.</span><span class="nx">json</span><span class="p">(</span><span class="nx">apiKey</span><span class="p">);</span>
    <span class="p">}</span>
  <span class="p">});</span>
<span class="p">});</span>
</pre></div>
</div>
<p>This is a naive example which simply prints out the API Keys for the user, but
once they have the keys they will be able to authenticate with your API.  For
more information on API Keys, please see <a class="reference external" href="https://docs.stormpath.com/guides/api-key-management/">Using Stormpath for API Authentication</a></p>
<p>The next sections will show you how a developer can use those keys to authenticate
with your API.</p>
</div>
<div class="section" id="http-basic-authentication">
<h3>HTTP Basic Authentication<a class="headerlink" href="#http-basic-authentication" title="Permalink to this headline">¶</a></h3>
<p>This strategy makes sense if you are building a simple API service that does
not have complex needs around authorization and resource control.  This strategy
is simple because the developer simply supplies their API keys on every request
to your server.</p>
<p>Once the developer has their API keys, they will use them to authenticate with your
API.  For each request they will set the <code class="docutils literal"><span class="pre">Authorization</span></code> header, like this:</p>
<div class="highlight-javascript"><div class="highlight"><pre><span></span><span class="nx">Authorization</span><span class="o">:</span> <span class="nx">Basic</span> <span class="o">&lt;</span><span class="nx">Base64UrlSafe</span><span class="p">(</span><span class="nx">apiKeyId</span><span class="o">:</span><span class="nx">apiKeySecret</span><span class="p">)</span><span class="o">&gt;</span>
</pre></div>
</div>
<p>How this is done will depend on what tool or library they are using.  For example,
if using curl:</p>
<div class="highlight-sh"><div class="highlight"><pre><span></span>curl -v --user apiKeyId:apiKeySecret http://localhost:3000/secret
</pre></div>
</div>
<p>Or if you’re using the <code class="docutils literal"><span class="pre">request</span></code> library:</p>
<div class="highlight-javascript"><div class="highlight"><pre><span></span><span class="kd">var</span> <span class="nx">request</span> <span class="o">=</span> <span class="nx">require</span><span class="p">(</span><span class="s1">&#39;request&#39;</span><span class="p">);</span>

<span class="nx">request</span><span class="p">({</span>
  <span class="nx">url</span><span class="o">:</span> <span class="s1">&#39;http://localhost:3000/secret&#39;</span><span class="p">,</span>
  <span class="nx">auth</span><span class="o">:</span> <span class="p">{</span>
    <span class="nx">user</span><span class="o">:</span> <span class="s1">&#39;apiKeyId&#39;</span><span class="p">,</span>
    <span class="nx">pass</span><span class="o">:</span> <span class="s1">&#39;apiKeySecret&#39;</span>
  <span class="p">}</span>
<span class="p">},</span> <span class="kd">function</span> <span class="p">(</span><span class="nx">err</span><span class="p">,</span> <span class="nx">res</span><span class="p">){</span>
  <span class="nx">console</span><span class="p">.</span><span class="nx">log</span><span class="p">(</span><span class="nx">res</span><span class="p">.</span><span class="nx">body</span><span class="p">);</span>
<span class="p">});</span>
</pre></div>
</div>
<p>You will need to tell your application that you want to secure this endpoint and
allow basic authentication.  This is done with the <code class="docutils literal"><span class="pre">apiAuthenticationRequired</span></code>
middleware:</p>
<div class="highlight-javascript"><div class="highlight"><pre><span></span><span class="nx">app</span><span class="p">.</span><span class="nx">get</span><span class="p">(</span><span class="s1">&#39;/secret&#39;</span><span class="p">,</span> <span class="nx">stormpath</span><span class="p">.</span><span class="nx">apiAuthenticationRequired</span><span class="p">,</span> <span class="kd">function</span> <span class="p">(</span><span class="nx">req</span><span class="p">,</span> <span class="nx">res</span><span class="p">)</span> <span class="p">{</span>
  <span class="nx">res</span><span class="p">.</span><span class="nx">json</span><span class="p">({</span>
    <span class="nx">message</span><span class="o">:</span> <span class="s2">&quot;Hello, &quot;</span> <span class="o">+</span> <span class="nx">req</span><span class="p">.</span><span class="nx">user</span><span class="p">.</span><span class="nx">fullname</span>
  <span class="p">});</span>
<span class="p">});</span>
</pre></div>
</div>
</div>
<div class="section" id="oauth2-client-credentials">
<h3>OAuth2 Client Credentials<a class="headerlink" href="#oauth2-client-credentials" title="Permalink to this headline">¶</a></h3>
<p>If you are building an API service and you have complex needs around
authorization and security, this strategy should be used.  In this situation
the developer does a one-time exchange of their API Keys for an Access Token.
This Access Token is time limited and must be periodically refreshed.  This adds a
layer of security, at the cost of being less simple than HTTP Basic
Authentication.</p>
<p>If you’re not sure which strategy to use, it’s best to start with HTTP Basic
Authentication. You can always switch to OAuth2 at a later time.</p>
<p>Once a developer has an API Key pair (see above, <em>Issuing API Keys</em>), they will
need to use the OAuth2 Token Endpoint to obtain an Access Token.  In simple
HTTP terms, that request looks like this:</p>
<div class="highlight-text"><div class="highlight"><pre><span></span>POST /oauth/token HTTP/1.1
Host: myapi.com
Content-Type: application/x-www-form-urlencoded
Authorization: Basic &lt;Base64UrlSafe(apiKeyId:apiKeySecret)&gt;

grant_type=client_credentials
</pre></div>
</div>
<p>How you construct this request will depend on your library or tool, but the key
parts you need to know are:</p>
<blockquote>
<div><ul class="simple">
<li>The request must be a POST request.</li>
<li>The content type must be form encoded, and the body must contain
<code class="docutils literal"><span class="pre">grant_type=client_credentials</span></code>.</li>
<li>The Authorization header must be Basic and contain the Base64 Url-Encoded
values of the Api Key Pair.</li>
</ul>
</div></blockquote>
<p>If you were doing this request with curl, it would look like this:</p>
<div class="highlight-sh"><div class="highlight"><pre><span></span>curl -X POST --user api_key_id:api_key_secret http://localhost:3000/oauth/token -d <span class="nv">grant_type</span><span class="o">=</span>client_credentials
</pre></div>
</div>
<p>Or if using the <code class="docutils literal"><span class="pre">request</span></code> library:</p>
<div class="highlight-javascript"><div class="highlight"><pre><span></span><span class="nx">request</span><span class="p">({</span>
  <span class="nx">url</span><span class="o">:</span> <span class="s1">&#39;http://localhost:3000/oauth/token&#39;</span><span class="p">,</span>
  <span class="nx">method</span><span class="o">:</span> <span class="s1">&#39;POST&#39;</span><span class="p">,</span>
  <span class="nx">auth</span><span class="o">:</span> <span class="p">{</span>
    <span class="nx">user</span><span class="o">:</span> <span class="s1">&#39;1BWQHHJCOW90HI7HFQ5LTD6O0&#39;</span><span class="p">,</span>
    <span class="nx">pass</span><span class="o">:</span> <span class="s1">&#39;zzeu+NwmicjtJ9yDJ2KlRguC+8uTjKVm3AMs80ah6hw&#39;</span>
  <span class="p">},</span>
  <span class="nx">form</span><span class="o">:</span> <span class="p">{</span>
    <span class="s1">&#39;grant_type&#39;</span><span class="o">:</span> <span class="s1">&#39;client_credentials&#39;</span>
  <span class="p">}</span>
<span class="p">},</span><span class="kd">function</span> <span class="p">(</span><span class="nx">err</span><span class="p">,</span><span class="nx">res</span><span class="p">)</span> <span class="p">{</span>
  <span class="nx">console</span><span class="p">.</span><span class="nx">log</span><span class="p">(</span><span class="nx">res</span><span class="p">.</span><span class="nx">body</span><span class="p">);</span>
<span class="p">});</span>
</pre></div>
</div>
<p>If the credentials are valid, you will get an Access Token response that looks
like this:</p>
<div class="highlight-javascript"><div class="highlight"><pre><span></span><span class="p">{</span>
  <span class="s2">&quot;access_token&quot;</span><span class="o">:</span> <span class="s2">&quot;eyJ0eXAiOiJKV1QiL...&quot;</span><span class="p">,</span>
  <span class="s2">&quot;token_type&quot;</span><span class="o">:</span> <span class="s2">&quot;bearer&quot;</span><span class="p">,</span>
  <span class="s2">&quot;expires_in&quot;</span><span class="o">:</span> <span class="mi">3600</span>
<span class="p">}</span>
</pre></div>
</div>
<p>The response is a JSON object which contains:</p>
<ul class="simple">
<li><code class="docutils literal"><span class="pre">access_token</span></code> - Your OAuth Access Token.  This can be used to authenticate
on future requests.</li>
<li><code class="docutils literal"><span class="pre">token_type</span></code> - This will always be <code class="docutils literal"><span class="pre">&quot;bearer&quot;</span></code>.</li>
<li><code class="docutils literal"><span class="pre">expires_in</span></code> - This is the amount of seconds (<em>as an integer</em>) for which
this token is valid.</li>
</ul>
<p>With this token you can now make requests to your API.  This request is simpler,
as only thing you need to supply is <code class="docutils literal"><span class="pre">Authorization</span></code> header with the Access
Token as a bearer token.  If you are using curl, that request looks like this:</p>
<div class="highlight-sh"><div class="highlight"><pre><span></span>curl -v -H <span class="s2">&quot;Authorization: Bearer eyJ0eXAiOiJKV1QiL...&quot;</span> http://localhost:3000/secret
</pre></div>
</div>
<p>Or if using the <code class="docutils literal"><span class="pre">request</span></code> library:</p>
<div class="highlight-javascript"><div class="highlight"><pre><span></span><span class="nx">request</span><span class="p">({</span>
  <span class="nx">url</span><span class="o">:</span> <span class="s1">&#39;http://localhost:3000/secret&#39;</span><span class="p">,</span>
  <span class="nx">auth</span><span class="o">:</span> <span class="p">{</span>
    <span class="s1">&#39;bearer&#39;</span><span class="o">:</span> <span class="s1">&#39;eyJ0eXAiOiJKV1QiL...&#39;</span>
  <span class="p">}</span>
<span class="p">},</span> <span class="kd">function</span> <span class="p">(</span><span class="nx">err</span><span class="p">,</span> <span class="nx">res</span><span class="p">){</span>
  <span class="nx">console</span><span class="p">.</span><span class="nx">log</span><span class="p">(</span><span class="nx">res</span><span class="p">.</span><span class="nx">body</span><span class="p">);</span>
<span class="p">});</span>
</pre></div>
</div>
<p>In order to protect your API endpoint and allow this form of authentication,
you need to use the <code class="docutils literal"><span class="pre">apiAuthenticationRequired</span></code> middleware:</p>
<div class="highlight-javascript"><div class="highlight"><pre><span></span><span class="nx">app</span><span class="p">.</span><span class="nx">get</span><span class="p">(</span><span class="s1">&#39;/secret&#39;</span><span class="p">,</span> <span class="nx">stormpath</span><span class="p">.</span><span class="nx">apiAuthenticationRequired</span><span class="p">,</span> <span class="kd">function</span> <span class="p">(</span><span class="nx">req</span><span class="p">,</span> <span class="nx">res</span><span class="p">)</span> <span class="p">{</span>
  <span class="nx">res</span><span class="p">.</span><span class="nx">json</span><span class="p">({</span>
    <span class="nx">message</span><span class="o">:</span> <span class="s2">&quot;Hello, &quot;</span> <span class="o">+</span> <span class="nx">req</span><span class="p">.</span><span class="nx">user</span><span class="p">.</span><span class="nx">fullname</span>
  <span class="p">});</span>
<span class="p">});</span>
</pre></div>
</div>
<p>By default the Access Tokens are valid for one hour.  If you want to change
the expiration of these tokens you will need to configure it in the server
configuration, like this:</p>
<div class="highlight-javascript"><div class="highlight"><pre><span></span><span class="nx">app</span><span class="p">.</span><span class="nx">use</span><span class="p">(</span><span class="nx">stormpath</span><span class="p">.</span><span class="nx">init</span><span class="p">(</span><span class="nx">app</span><span class="p">,</span> <span class="p">{</span>
  <span class="nx">web</span><span class="o">:</span> <span class="p">{</span>
    <span class="nx">oauth2</span><span class="o">:</span> <span class="p">{</span>
      <span class="nx">client_credentials</span><span class="o">:</span> <span class="p">{</span>
        <span class="nx">accessToken</span><span class="o">:</span> <span class="p">{</span>
          <span class="nx">ttl</span><span class="o">:</span> <span class="mi">3600</span> <span class="c1">// your custom TTL, in seconds, goes here</span>
        <span class="p">}</span>
      <span class="p">}</span>
    <span class="p">}</span>
  <span class="p">}</span>
<span class="p">}));</span>
</pre></div>
</div>
</div>
</div>
</div>


           </div>
          </div>
          <footer>
  
    <div class="rst-footer-buttons" role="navigation" aria-label="footer navigation">
      
        <a href="authorization.html" class="btn btn-neutral float-right" title="Authorization" accesskey="n">Next <span class="fa fa-arrow-circle-right"></span></a>
      
      
        <a href="user_data.html" class="btn btn-neutral" title="User Data" accesskey="p"><span class="fa fa-arrow-circle-left"></span> Previous</a>
      
    </div>
  

  <hr/>

  <div role="contentinfo">
    <p>
        &copy; Copyright 2014, Stormpath, Inc..

    </p>
  </div>
  Built with <a href="http://sphinx-doc.org/">Sphinx</a> using a <a href="https://github.com/snide/sphinx_rtd_theme">theme</a> provided by <a href="https://readthedocs.org">Read the Docs</a>. 

</footer>

        </div>
      </div>

    </section>

  </div>
  


  

    <script type="text/javascript">
        var DOCUMENTATION_OPTIONS = {
            URL_ROOT:'./',
            VERSION:'4.0.0',
            COLLAPSE_INDEX:false,
            FILE_SUFFIX:'.html',
            HAS_SOURCE:  true
        };
    </script>
      <script type="text/javascript" src="_static/jquery.js"></script>
      <script type="text/javascript" src="_static/underscore.js"></script>
      <script type="text/javascript" src="_static/doctools.js"></script>

  

  
  
    <script type="text/javascript" src="_static/js/theme.js"></script>
  

  
  
  <script type="text/javascript">
      jQuery(function () {
          SphinxRtdTheme.StickyNav.enable();
      });
  </script>
   

  

</body>
</html>