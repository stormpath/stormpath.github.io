

<!DOCTYPE html>
<!--[if IE 8]><html class="no-js lt-ie9" lang="en" > <![endif]-->
<!--[if gt IE 8]><!--> <html class="no-js" lang="en" > <!--<![endif]-->
<head>
  <meta charset="utf-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  
  <title>Caching &mdash; Stormpath Java Servlet Plugin 1.0.RC7.5 documentation</title>
  

  
  

  
  <link href='https://fonts.googleapis.com/css?family=Lato:400,700,400italic,700italic|Roboto+Slab:400,700|Inconsolata:400,700' rel='stylesheet' type='text/css'>

  
  
    

  

  
  
    <link rel="stylesheet" href="_static/css/theme.css" type="text/css" />
  

  
        <link rel="author" title="About these documents"
              href="about.html"/>
    <link rel="top" title="Stormpath Java Servlet Plugin 1.0.RC7.5 documentation" href="index.html"/>
        <link rel="next" title="Custom Views" href="views.html"/>
        <link rel="prev" title="Events" href="events.html"/> 

  
  <script src="https://cdnjs.cloudflare.com/ajax/libs/modernizr/2.6.2/modernizr.min.js"></script>

</head>

<body class="wy-body-for-nav" role="document">

  <div class="wy-grid-for-nav">

    
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-nav-search">
        <a href="index.html" class="fa fa-home"> Stormpath Java Servlet Plugin</a>
        <div role="search">
  <form id ="rtd-search-form" class="wy-form" action="search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>
      </div>

      <div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="main navigation">
        
        
            <ul class="current">
<li class="toctree-l1"><a class="reference internal" href="about.html">About</a><ul>
<li class="toctree-l2"><a class="reference internal" href="about.html#what-is-stormpath">What is Stormpath?</a></li>
<li class="toctree-l2"><a class="reference internal" href="about.html#what-is-the-stormpath-java-servlet-plugin">What is the Stormpath Java Servlet Plugin?</a></li>
<li class="toctree-l2"><a class="reference internal" href="about.html#who-should-use-stormpath">Who should use Stormpath?</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="quickstart.html">Quickstart</a><ul>
<li class="toctree-l2"><a class="reference internal" href="quickstart.html#get-an-api-key">Get an API Key</a></li>
<li class="toctree-l2"><a class="reference internal" href="quickstart.html#add-the-stormpath-java-servlet-plugin">Add the Stormpath Java Servlet Plugin</a></li>
<li class="toctree-l2"><a class="reference internal" href="quickstart.html#try-it">Try it!</a></li>
<li class="toctree-l2"><a class="reference internal" href="quickstart.html#next-steps">Next Steps</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="config.html">Configuration</a><ul>
<li class="toctree-l2"><a class="reference internal" href="config.html#no-config">No Config?</a></li>
<li class="toctree-l2"><a class="reference internal" href="config.html#web-xml">web.xml</a></li>
<li class="toctree-l2"><a class="reference internal" href="config.html#stormpath-properties">stormpath.properties</a></li>
<li class="toctree-l2"><a class="reference internal" href="config.html#sdk-client">SDK Client</a></li>
<li class="toctree-l2"><a class="reference internal" href="config.html#stormpath-application">Stormpath Application</a></li>
<li class="toctree-l2"><a class="reference internal" href="config.html#filters">Filters</a></li>
<li class="toctree-l2"><a class="reference internal" href="config.html#uris">URIs</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="registration.html">Registration</a><ul>
<li class="toctree-l2"><a class="reference internal" href="registration.html#overview">Overview</a></li>
<li class="toctree-l2"><a class="reference internal" href="registration.html#uri">URI</a></li>
<li class="toctree-l2"><a class="reference internal" href="registration.html#next-uri">Next URI</a></li>
<li class="toctree-l2"><a class="reference internal" href="registration.html#form-fields">Form Fields</a></li>
<li class="toctree-l2"><a class="reference internal" href="registration.html#i18n">i18n</a></li>
<li class="toctree-l2"><a class="reference internal" href="registration.html#email-verification">Email Verification</a></li>
<li class="toctree-l2"><a class="reference internal" href="registration.html#events">Events</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="login.html">Login</a><ul>
<li class="toctree-l2"><a class="reference internal" href="login.html#overview">Overview</a></li>
<li class="toctree-l2"><a class="reference internal" href="login.html#security-notice">Security Notice</a></li>
<li class="toctree-l2"><a class="reference internal" href="login.html#uri">URI</a></li>
<li class="toctree-l2"><a class="reference internal" href="login.html#next-uri">Next URI</a></li>
<li class="toctree-l2"><a class="reference internal" href="login.html#i18n">i18n</a></li>
<li class="toctree-l2"><a class="reference internal" href="login.html#events">Events</a></li>
<li class="toctree-l2"><a class="reference internal" href="login.html#authentication-state">Authentication State</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="forgot-password.html">Forgot Password</a><ul>
<li class="toctree-l2"><a class="reference internal" href="forgot-password.html#overview">Overview</a></li>
<li class="toctree-l2"><a class="reference internal" href="forgot-password.html#configure-the-workflow">Configure the Workflow</a></li>
<li class="toctree-l2"><a class="reference internal" href="forgot-password.html#try-it">Try it!</a></li>
<li class="toctree-l2"><a class="reference internal" href="forgot-password.html#forgot-uri">Forgot URI</a></li>
<li class="toctree-l2"><a class="reference internal" href="forgot-password.html#forgot-next-uri">Forgot Next URI</a></li>
<li class="toctree-l2"><a class="reference internal" href="forgot-password.html#change-password-uri">Change Password URI</a></li>
<li class="toctree-l2"><a class="reference internal" href="forgot-password.html#change-password-next-uri">Change Password Next URI</a></li>
<li class="toctree-l2"><a class="reference internal" href="forgot-password.html#i18n">i18n</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="logout.html">Logout</a><ul>
<li class="toctree-l2"><a class="reference internal" href="logout.html#uri">URI</a></li>
<li class="toctree-l2"><a class="reference internal" href="logout.html#next-uri">Next URI</a></li>
<li class="toctree-l2"><a class="reference internal" href="logout.html#events">Events</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="http-request-authentication.html">HTTP Request Authentication</a><ul>
<li class="toctree-l2"><a class="reference internal" href="http-request-authentication.html#http-basic-authentication">HTTP Basic Authentication</a></li>
<li class="toctree-l2"><a class="reference internal" href="http-request-authentication.html#token-authentication">Token Authentication</a></li>
<li class="toctree-l2"><a class="reference internal" href="http-request-authentication.html#api-key-authentication">API Key Authentication</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="request.html">Request Context</a><ul>
<li class="toctree-l2"><a class="reference internal" href="request.html#current-user-account">Current User Account</a></li>
<li class="toctree-l2"><a class="reference internal" href="request.html#stormpath-application">Stormpath Application</a></li>
<li class="toctree-l2"><a class="reference internal" href="request.html#stormpath-sdk-client">Stormpath SDK Client</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="access-control.html">Access Control</a><ul>
<li class="toctree-l2"><a class="reference internal" href="access-control.html#authentication">Authentication</a></li>
<li class="toctree-l2"><a class="reference internal" href="access-control.html#authorization">Authorization</a></li>
<li class="toctree-l2"><a class="reference internal" href="access-control.html#exclusions">Exclusions</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="i18n.html">Internationalization (i18n)</a><ul>
<li class="toctree-l2"><a class="reference internal" href="i18n.html#languages">Languages</a></li>
<li class="toctree-l2"><a class="reference internal" href="i18n.html#request-locale">Request Locale</a></li>
<li class="toctree-l2"><a class="reference internal" href="i18n.html#jsp-tag-library">JSP Tag Library</a></li>
<li class="toctree-l2"><a class="reference internal" href="i18n.html#i18n-properties">i18n.properties</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="events.html">Events</a><ul>
<li class="toctree-l2"><a class="reference internal" href="events.html#requesteventlistener">RequestEventListener</a></li>
<li class="toctree-l2"><a class="reference internal" href="events.html#id2">Events</a></li>
<li class="toctree-l2"><a class="reference internal" href="events.html#listener-best-practices">Listener Best Practices</a></li>
</ul>
</li>
<li class="toctree-l1 current"><a class="current reference internal" href="">Caching</a><ul>
<li class="toctree-l2"><a class="reference internal" href="#in-process-cache">In-Process Cache</a></li>
<li class="toctree-l2"><a class="reference internal" href="#shared-cache">Shared Cache</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="views.html">Custom Views</a><ul>
<li class="toctree-l2"><a class="reference internal" href="views.html#jsp-views">JSP Views</a></li>
<li class="toctree-l2"><a class="reference internal" href="views.html#css">CSS</a></li>
<li class="toctree-l2"><a class="reference internal" href="views.html#internationalization-i18n">Internationalization (i18n)</a></li>
<li class="toctree-l2"><a class="reference internal" href="views.html#change-a-default-view">Change a Default View</a></li>
<li class="toctree-l2"><a class="reference internal" href="views.html#view-template">View Template</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="appendix.html">Appendix</a><ul>
<li class="toctree-l2"><a class="reference internal" href="appendix/default-stormpath-properties.html">A: default.stormpath.properties</a></li>
<li class="toctree-l2"><a class="reference internal" href="appendix/i18n-properties.html">B: i18n.properties</a></li>
<li class="toctree-l2"><a class="reference internal" href="appendix/stormpath-css.html">C: stormpath.css</a></li>
</ul>
</li>
</ul>

        
      </div>
      &nbsp;
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap">

      
      <nav class="wy-nav-top" role="navigation" aria-label="top navigation">
        <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
        <a href="index.html">Stormpath Java Servlet Plugin</a>
      </nav>


      
      <div class="wy-nav-content">
        <div class="rst-content">
          <div role="navigation" aria-label="breadcrumbs navigation">
  <ul class="wy-breadcrumbs">
    <li><a href="index.html">Docs</a> &raquo;</li>
      
    <li>Caching</li>
      <li class="wy-breadcrumbs-aside">
        
          <a href="_sources/caching.txt" rel="nofollow"> View page source</a>
        
      </li>
  </ul>
  <hr/>
</div>
          <div role="main">
            
  <div class="section" id="caching">
<span id="id1"></span><h1>Caching<a class="headerlink" href="#caching" title="Permalink to this headline">¶</a></h1>
<p>The Stormpath Java Servlet Plugin delegates to an SDK Client, which supports caching to reduce round-trips to the Stormpath API servers and to improve performance.</p>
<p>The plugin enables a single (non-clustered) in-process memory cache for the SDK Client by default.  This behavior is relevant for web applications that are deployed to a single JVM only.  If your web application is deployed on multiple web hosts/nodes simultaneously (i.e. a striped or clustered application), then you will likely want to <a class="reference internal" href="#shared-cache"><span>enable a shared cache</span></a> instead to ensure that cached data remains coherent across all web application nodes.</p>
<div class="section" id="in-process-cache">
<h2>In-Process Cache<a class="headerlink" href="#in-process-cache" title="Permalink to this headline">¶</a></h2>
<p>You can configure the out-of-the-box in-memory cache for the single-JVM application use case using <a class="reference internal" href="config.html#config"><span>configuration properties</span></a>.</p>
<p>The cache memory space is segmented into regions or &#8216;sections&#8217;, allowing you to specify different caching behavior for each region.</p>
<div class="section" id="default-ttl">
<span id="id2"></span><h3>Default TTL<a class="headerlink" href="#default-ttl" title="Permalink to this headline">¶</a></h3>
<p>TTL, or &#8216;Time to Live&#8217; is how long a cache entry is allowed to remain in the cache, regardless of how often it is accessed.  After this amount of time, the cache entry will considered invalid and will removed (&#8216;evicted&#8217;) from the cache.</p>
<p>You can specify the default TTL value for all cache regions by setting the <code class="docutils literal"><span class="pre">stormpath.cache.ttl</span></code> value in milliseconds:</p>
<div class="highlight-properties"><div class="highlight"><pre><span class="c"># 3,600,000 milliseconds = 1 hour</span>
<span class="na">stormpath.cache.ttl</span> <span class="o">=</span> <span class="s">3600000</span>
</pre></div>
</div>
</div>
<div class="section" id="default-tti">
<h3>Default TTI<a class="headerlink" href="#default-tti" title="Permalink to this headline">¶</a></h3>
<p>TTI, or &#8216;Time to Idle&#8217; is how long a cache entry is allowed to remain idle (unreferenced, not used) in the cache before it can be removed (&#8216;evicted&#8217;) from the cache.</p>
<p>You can specify the default TTI value for all cache regions by setting the <code class="docutils literal"><span class="pre">stormpath.cache.tti</span></code> value in milliseconds:</p>
<div class="highlight-properties"><div class="highlight"><pre><span class="c"># 3,600,000 milliseconds = 1 hour</span>
<span class="na">stormpath.cache.ttl</span> <span class="o">=</span> <span class="s">3600000</span>
</pre></div>
</div>
</div>
<div class="section" id="cache-regions">
<h3>Cache Regions<a class="headerlink" href="#cache-regions" title="Permalink to this headline">¶</a></h3>
<p>Cache Regions are automatically created as they are requested and use the default ttl and tti - you do not need to configure them explicitly.</p>
<p>However, if you want to specify a cache region&#8217;s TTL or TTI, you can do so using a configuration property convention; prefix the region name <code class="docutils literal"><span class="pre">stormpath.cache.</span></code> and suffix the name with <code class="docutils literal"><span class="pre">.ttl</span></code> or <code class="docutils literal"><span class="pre">tti</span></code> for TTL or TTI respectively.</p>
<p>For example, let&#8217;s assume we have a cache region named <code class="docutils literal"><span class="pre">My</span> <span class="pre">Test</span> <span class="pre">Cache</span> <span class="pre">Region</span></code> and wanted a 5 minute time-to-idle and a 30 minute time-to-live.  We&#8217;d define two configuration properties as follows:</p>
<div class="highlight-properties"><div class="highlight"><pre><span class="c"># 300,000 millis = 5 minutes:</span>
<span class="na">stormpath.cache.My Test Cache Region.tti</span> <span class="o">=</span> <span class="s">300000</span>

<span class="c"># 1,800,000 millis = 30 minutes:</span>
<span class="na">stormpath.cache.My Test Cache Region.ttl</span> <span class="o">=</span> <span class="s">1800000</span>
</pre></div>
</div>
<p>If a cache region does not have configured <code class="docutils literal"><span class="pre">.tti</span></code> or <code class="docutils literal"><span class="pre">.ttl</span></code> values, the <a class="reference internal" href="#default-ttl"><span>default ttl and tti values</span></a> are assumed.</p>
</div>
<div class="section" id="client-cache-regions">
<h3>Client Cache Regions<a class="headerlink" href="#client-cache-regions" title="Permalink to this headline">¶</a></h3>
<p>The Stormpath Client creates a cache region <em>per</em> resource data type.  That is, all cached Accounts are in one region, all cached Groups are in another, etc.  The region names are equal to the fully qualified <em>interface</em> name of each resource type.  For example:</p>
<ul class="simple">
<li><code class="docutils literal"><span class="pre">com.stormpath.sdk.account.Account</span></code></li>
<li><code class="docutils literal"><span class="pre">com.stormpath.sdk.group.Group</span></code></li>
<li>etc...</li>
</ul>
<p>If you want to configure caching rules for a particular client resource type, when adding the necessary property prefix and suffix, you might have the following config lines (for example):</p>
<div class="highlight-properties"><div class="highlight"><pre><span class="na">stormpath.cache.com.stormpath.sdk.account.Account.tti</span> <span class="o">=</span> <span class="s">3600000</span>

<span class="na">stormpath.cache.com.stormpath.sdk.group.Group.ttl</span> <span class="o">=</span> <span class="s">4800000</span>
</pre></div>
</div>
</div>
</div>
<div class="section" id="shared-cache">
<span id="id3"></span><h2>Shared Cache<a class="headerlink" href="#shared-cache" title="Permalink to this headline">¶</a></h2>
<p>Each web application instance will, by default, have its <em>own</em> private in-process cache as described above.</p>
<p>However, if your web application .war is deployed on multiple JVMs - for example, you load balance requests across multiple identical web application nodes - you may experience data cache inconsistency problems if the default cache remains enabled: separate private cache instances are often not desirable because each web app instance could see its own &#8216;version&#8217; of the cached data.</p>
<p>For example, if a user sends a request that is directed to web app instance A and then a subsequent request is directed to web app instance B, and the two instances do not agree on the same cached data, this could cause data integrity problems in many applications. This can be solved by using a shared or distributed cache to ensure cache consistency, also known as <a class="reference external" href="http://en.wikipedia.org/wiki/Cache_coherence">cache coherence</a>.</p>
<p>If you need cache coherency, you will want to specify a <code class="docutils literal"><span class="pre">com.stormpath.sdk.cache.CacheManager</span></code> implementation that can communicate with a shared or distributed cache system, like Hazelcast, Redis, etc.</p>
<p>You can do this by specifying the <code class="docutils literal"><span class="pre">stormpath.cache.manager</span></code> configuration property, for example:</p>
<div class="highlight-properties"><div class="highlight"><pre><span class="na">stormpath.cache.manager</span> <span class="o">=</span> <span class="s">your.fully.qualified.implementation.of.CacheManager</span>
</pre></div>
</div>
</div>
</div>


          </div>
          <footer>
  
    <div class="rst-footer-buttons" role="navigation" aria-label="footer navigation">
      
        <a href="views.html" class="btn btn-neutral float-right" title="Custom Views">Next <span class="fa fa-arrow-circle-right"></span></a>
      
      
        <a href="events.html" class="btn btn-neutral" title="Events"><span class="fa fa-arrow-circle-left"></span> Previous</a>
      
    </div>
  

  <hr/>

  <div role="contentinfo">
    <p>
        &copy; Copyright 2014, Stormpath, Inc..
    </p>
  </div>

  <a href="https://github.com/snide/sphinx_rtd_theme">Sphinx theme</a> provided by <a href="https://readthedocs.org">Read the Docs</a>
</footer>
        </div>
      </div>

    </section>

  </div>
  


  

    <script type="text/javascript">
        var DOCUMENTATION_OPTIONS = {
            URL_ROOT:'./',
            VERSION:'1.0.RC7.5',
            COLLAPSE_INDEX:false,
            FILE_SUFFIX:'.html',
            HAS_SOURCE:  true
        };
    </script>
      <script type="text/javascript" src="_static/jquery.js"></script>
      <script type="text/javascript" src="_static/underscore.js"></script>
      <script type="text/javascript" src="_static/doctools.js"></script>

  

  
  
    <script type="text/javascript" src="_static/js/theme.js"></script>
  

  
  
  <script type="text/javascript">
      jQuery(function () {
          SphinxRtdTheme.StickyNav.enable();
      });
  </script>
  
   
  <script>
    (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
        (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
            m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
    })(window,document,'script','//www.google-analytics.com/analytics.js','ga');
    ga('create', 'UA-29159574-1', 'auto');
    ga('send', 'pageview');
  </script>
  <script type="text/javascript">
    (function(d,s,i,r) {
        if (d.getElementById(i)){return;}
        var n=d.createElement(s),e=d.getElementsByTagName(s)[0];
        n.id=i;n.src='//js.hs-analytics.net/analytics/'+(Math.ceil(new Date()/r)*r)+'/475298.js';
        e.parentNode.insertBefore(n, e);
    })(document,"script","hs-analytics",300000);
  </script>
  <script type="text/javascript">
    var _kmq = _kmq || [];
    var _kmk = _kmk || '684b854336bd3a6523260ebd991eec06b18b929a';
    function _kms(u){
        setTimeout(function(){
            var d = document, f = d.getElementsByTagName('script')[0],
                    s = d.createElement('script');
            s.type = 'text/javascript'; s.async = true; s.src = u;
            f.parentNode.insertBefore(s, f);
        }, 1);
    }
    _kms('//i.kissmetrics.com/i.js');
    _kms('//doug1izaerwt3.cloudfront.net/' + _kmk + '.1.js');
  </script>
  <script src="//cdn.optimizely.com/js/225847041.js"></script>


</body>
</html>